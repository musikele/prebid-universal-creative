{"version":3,"sources":["webpack:///webpack/bootstrap 054deb7ab036aadc5171","webpack:///./src/utils.js","webpack:///./src/messaging.js","webpack:///./src/nativeTrackers.js","webpack:///./src/nativeTrackerManager.js","webpack:///./src/domHelper.js","webpack:///./node_modules/postscribe/dist/postscribe.js","webpack:///./src/nativeAssetManager.js","webpack:///./src/nativeORTBTrackerManager.js","webpack:///./src/environment.js"],"names":["postscribe","require","triggerPixel","url","done","img","Image","addEventListener","src","createTrackPixelHtml","escapedUrl","encodeURI","writeAdUrl","adUrl","width","height","iframe","domHelper","getEmptyIframe","document","body","appendChild","writeAdHtml","markup","error","console","sendRequest","callback","reqListener","oReq","responseText","XMLHttpRequest","open","send","getUUID","d","Date","getTime","uuid","replace","c","r","Math","random","floor","toString","loadScript","currentWindow","tagSrc","successCallback","errorCallback","doc","scriptTag","createElement","type","readyState","onreadystatechange","onload","onerror","elToAppend","getElementsByTagName","length","insertBefore","firstChild","getCreativeComment","bid","createComment","crid","getCreativeCommentMarkup","creativeComment","exports","wrapper","innerHTML","transformAuctionTargetingData","tagData","auctionKeyMap","hb_adid","hb_cache_host","hb_cache_path","hb_cache_id","hb_format","hb_env","hb_size","hb_pb","isMacroPresent","paramName","isPlainObject","Object","keys","isStr","convertTargetingMapToNormalMap","tarMap","newTarMap","forEach","key","Array","isArray","convertKeyPairStringToMap","keywordsStr","keywordsMap","keywordsArr","split","keyPairStr","keyPairArr","k","v","renameKnownAuctionKeys","adServerKeyMap","internalKey","auctionData","formattedKeyMap","targetingMap","targetingKeywords","parseUrl","parsed","href","decodeURIComponent","protocol","hostname","port","pathname","hash","host","window","location","isA","object","_t","prototype","call","prebidMessenger","publisherURL","win","prebidDomain","parsedUrl","sendMessage","message","onResponse","Error","JSON","stringify","messagePort","parent","postMessage","channel","MessageChannel","port1","onmessage","windowListener","port2","stopListening","removeEventListener","ev","origin","originalEvent","pbNativeTag","nativeTrackerManager","startTrackers","AD_ANCHOR_CLASS_NAME","AD_DATA_ADID_ATTRIBUTE","newNativeTrackerManager","findAdElements","className","adElements","getElementsByClassName","readAdIdFromElement","adId","attributes","value","readAdIdFromSingleElement","adElement","loadClickTrackers","event","fireTracker","loadImpTrackers","i","attachClickListeners","listener","action","warn","dataObject","targetingData","pubUrl","nativeAssetManager","env","cb","clickTrackers","impTrackers","loadMobileClickTrackers","boundedLoadMobileClickTrackers","bind","loadMobileAssets","loadAssets","frame","setAttribute","insertElement","elm","target","e","envionment","NATIVE_KEYS","title","body2","privacyLink","sponsoredBy","image","icon","clickUrl","displayUrl","cta","rating","address","downloads","likes","phone","price","salePrice","rendererUrl","assetTypeMapping","DEFAULT_CACHE_HOST","DEFAULT_CACHE_PATH","newNativeAssetManager","errorCountEscapeHatch","cancelMessageListener","getCacheEndpoint","cacheHost","cachePath","path","parseResponse","response","bidObject","parse","log","transformToPrebidKeys","adMarkup","assets","clicktrackers","assetsFromMarkup","asset","push","data","text","link","imptrackers","requestAssetsFromCache","ajaxCallback","bidResponse","adm","newHtml","placeholders","scanForPlaceholders","flag","pbNativeData","hasOwnProperty","assetsToReplace","match","requestAllAssets","requestAssets","placeholderKey","placeholder","placeholderIndex","indexOf","head","replaceAssets","requestHeightResize","renderPayload","ortb","renderAd","getElementById","adTemplate","template","getCurrentFrameContainer","currentParentWindow","top","frames","idx","frameElement","contentWindow","parentElement","html","isSafeFrame","iframeContainer","getBoundingClientRect","style","clientHeight","offsetHeight","postRenderAd","replaceORTBAssetsAndLinks","getAssetValue","video","vasttag","id","privacy","replaceAll","searchString","searchStringRegex","RegExp","ASSET_ID_ELEMENT_ATTRIBUTE","fireNativeImpressionTrackers","eventTrackers","eventtrackers","impressionTrackers","filter","tracker","imgEventTrackers","method","map","jsEventTrackers","fireNativeClickTrackers","assetIdLinkMap","a","reduce","masterClickTrackers","targetElement","assetId","getAttribute","assetLink","newEnvironment","isAmp","isCrossDomain","$sf","ext","canInspectWindow","canLocatePrebid","result","pbjs","isMobileApp"],"mappings":"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ACS,oBAAJ,CAAyB,MAAzB,CAA9C;;AACA,QAAID,UAAU,CAACE,MAAf,EAAuB;AACrBF,gBAAU,GAAGA,UAAU,CAAC,CAAD,CAAvB;AACAA,gBAAU,CAACG,YAAX,CAAwBsI,GAAxB,EAA6BzI,UAAU,CAACI,UAAxC;AACD;AACF,GAND,CAME,OAAOuI,CAAP,EAAU,CAAE;AACf,C;;;;;;AC9CH;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,IAAI,IAAyD;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,uCAAuC,uCAAuC,kBAAkB;;AAEhG;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA;;AAEA,oDAAoD,gBAAgB,sBAAsB,OAAO,2BAA2B,0BAA0B,yDAAyD,2BAA2B,EAAE,EAAE,EAAE,eAAe;;AAE/P;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,wCAAwC,6BAA6B,YAAY,EAAE,OAAO,iBAAiB,mBAAmB,uBAAuB,4EAA4E,EAAE,EAAE,yBAAyB,eAAe,EAAE;;AAE/Q,uCAAuC,uCAAuC,kBAAkB;;AAEhG;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA,cAAc,OAAO;AACrB;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAc,MAAM;AACpB;AACA;AACA;AACA,IAAI;;;AAGJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,qEAAqE,aAAa;AAClF;AACA;;AAEA;AACA,MAAM;AACN;AACA,wEAAwE,eAAe;AACvF;AACA;;AAEA;AACA;AACA,IAAI;;AAEJ;AACA;;AAEA;AACA;AACA;AACA,oBAAoB,uCAAuC;AAC3D;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;;AAEA;AACA;AACA,gBAAgB;AAChB,IAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,IAAI;AACJ;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA,EAAE;;AAEF,OAAO;AACP;AACA;;AAEA;;AAEA;;AAEA,oDAAoD,gBAAgB,sBAAsB,OAAO,2BAA2B,0BAA0B,yDAAyD,2BAA2B,EAAE,EAAE,EAAE,eAAe;;AAE/P;;AAEA;;AAEA;;AAEA;;AAEA,wCAAwC,6BAA6B,YAAY,EAAE,OAAO,iBAAiB,mBAAmB,uBAAuB,4EAA4E,EAAE,EAAE,yBAAyB,eAAe,EAAE;;AAE/Q,uCAAuC,uCAAuC,kBAAkB;;AAEhG,kDAAkD,0CAA0C,0DAA0D,EAAE;;AAExJ;AACA;AACA,WAAW;AACX;AACA;;AAEA;AACA;AACA,WAAW;AACX;AACA;;AAEA;AACA;AACA,WAAW;AACX;AACA;;AAEA;AACA;AACA,WAAW;AACX;AACA;;AAEA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,cAAc;AACd;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA;AACA;;AAEA;;AAEA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,QAAQ;AACtB;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,mDAAmD,2BAA2B;;AAE9E;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,cAAc,UAAU;AACxB;;;AAGA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAc,SAAS;AACvB;AACA;;;AAGA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAc,cAAc;AAC5B,iBAAiB,2BAA2B;AAC5C;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,cAAc,cAAc;AAC5B,iBAAiB;AACjB;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,oBAAoB,SAAS;AAC7B;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB;;;AAGA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB;;;AAGA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB,gBAAgB;AAChB;;;AAGA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,MAAM;;AAEN;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB;;;AAGA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB;AACA;;;AAGA;AACA;AACA;AACA,2BAA2B,qDAAqD;AAChF;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,SAAS;AACvB;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB,gBAAgB;AAChB;;;AAGA;AACA;;AAEA;AACA;AACA;AACA,MAAM;;AAEN;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,SAAS;AACvB;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ,sBAAsB,uDAAuD;AAC7E;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA,YAAY;AACZ,sBAAsB,wDAAwD;AAC9E;AACA;AACA;AACA,kBAAkB,wCAAwC;AAC1D,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB,gBAAgB;AAChB;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA,EAAE;;AAEF;;AAEA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF,qCAAqC;AACrC;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,wCAAwC,uCAAuC,kBAAkB;;AAEjG;;AAEA,QAAQ;AACR;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,wCAAwC,uCAAuC,kBAAkB;;AAEjG,yCAAyC,6BAA6B,YAAY,EAAE,OAAO,iBAAiB,mBAAmB,uBAAuB,4EAA4E,EAAE,EAAE,yBAAyB,eAAe,EAAE;;AAEhR,mDAAmD,0CAA0C,0DAA0D,EAAE;;AAEzJ;AACA;AACA;AACA;AACA;;AAEA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,QAAQ;AACvB;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAAkD;AAClD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe,OAAO;AACtB;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe,OAAO;AACtB;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB;AACjB;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe,OAAO;AACtB;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,OAAO;AACxB;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,OAAO;AACxB;;;AAGA;AACA;AACA;;AAEA;AACA,GAAG;;AAEH;;;AAGA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,QAAQ;AACR;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;;AAEA;AACA;;AAEA,QAAQ;AACR;AACA;;AAEA;;AAEA;;AAEA,sGAAsG,mBAAmB,EAAE,mBAAmB,8HAA8H;;AAE5Q;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,OAAO;AACpB,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,OAAO;AACpB,eAAe;AACf;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,OAAO;AACpB,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;;AAEA;AACA,WAAW;;AAEX;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,OAAO;AACpB,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,OAAO;AACpB,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAQ;AACR;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA,mDAAmD,0CAA0C,0DAA0D,EAAE;;AAEzJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAG;;AAEH;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAG;;AAEH;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe,SAAS;AACxB,eAAe,QAAQ;AACvB,iBAAiB,OAAO;AACxB;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,GAAG;;AAEH;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA,eAAe,QAAQ;AACvB,eAAe,OAAO;AACtB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAG;;AAEH;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA,eAAe,OAAO;AACtB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAG;;AAEH;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAG;;AAEH,QAAQ;AACR;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,eAAe;AACf;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA,QAAQ;AACR;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;;AAEA;AACA;AACA;AACA,YAAY;AACZ;AACA;;AAEA;AACA;AACA;AACA,aAAa,MAAM;AACnB,eAAe,MAAM;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,WAAW;AACxB,aAAa,SAAS;AACtB,eAAe,MAAM;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,WAAW;AACxB,aAAa,aAAa;AAC1B;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,0BAA0B,eAAe;AACzC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,aAAa,WAAW;AACxB,aAAa,OAAO;AACpB,aAAa,QAAQ;AACrB,aAAa,QAAQ;AACrB,aAAa,SAAS;AACtB,eAAe;AACf;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA;;AAEA,qGAAqG,mBAAmB,EAAE,mBAAmB,8HAA8H;;AAE3Q;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,EAAE;AACd,cAAc,QAAQ;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,EAAE;AACd,cAAc,QAAQ;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,SAAS;AACrB,YAAY,SAAS;AACrB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA,cAAc,SAAS;AACvB;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,SAAS;AACrB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA,YAAY,EAAE;AACd,cAAc;AACd;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,MAAM;;AAEN;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,SAAS;AACrB,cAAc,EAAE;AAChB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,cAAc,QAAQ;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,OAAO;AACnB,cAAc,QAAQ;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,OAAO;AACnB,cAAc,QAAQ;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA,CAAC;AACD;AACA,sC;;;;;;;;;;;;;;ACliEA;;AACA;;AACA;;AACA;;AARA;;;;AAUA,IAAMC,UAAU,GAAG,iCAAe5E,MAAf,CAAnB;AACA;;;;;AAIA,IAAM6E,WAAW,GAAG;AAClBC,OAAK,EAAE,iBADW;AAElBrL,MAAI,EAAE,gBAFY;AAGlBsL,OAAK,EAAE,iBAHW;AAIlBC,aAAW,EAAE,mBAJK;AAKlBC,aAAW,EAAE,iBALK;AAMlBC,OAAK,EAAE,iBANW;AAOlBC,MAAI,EAAE,gBAPY;AAQlBC,UAAQ,EAAE,mBARQ;AASlBC,YAAU,EAAE,sBATM;AAUlBC,KAAG,EAAE,eAVa;AAWlBC,QAAM,EAAE,kBAXU;AAYlBC,SAAO,EAAE,mBAZS;AAalBC,WAAS,EAAE,qBAbO;AAclBC,OAAK,EAAE,iBAdW;AAelBC,OAAK,EAAE,iBAfW;AAgBlBC,OAAK,EAAE,iBAhBW;AAiBlBC,WAAS,EAAE,qBAjBO;AAkBlBC,aAAW,EAAE;AAlBK,CAApB,C,CAqBA;AACA;;AACA,IAAMC,gBAAgB,GAAG;AACvB,WAAS;AACP,OAAG,MADI;AAEP,OAAG;AAFI,GADc;AAKvB,UAAQ;AACN,OAAG,aADG;AAEN,OAAG,MAFG;AAGN,OAAG,QAHG;AAIN,OAAG,OAJG;AAKN,OAAG,WALG;AAMN,OAAG,OANG;AAON,OAAG,WAPG;AAQN,OAAG,OARG;AASN,OAAG,SATG;AAUN,QAAI,OAVE;AAWN,QAAI,YAXE;AAYN,QAAI;AAZE;AALe,CAAzB;AAqBA,IAAMC,kBAAkB,GAAG,kBAA3B;AACA,IAAMC,kBAAkB,GAAG,eAA3B;;AAEO,SAASC,qBAAT,CAA+BzF,GAA/B,EAAoCkD,MAApC,EAA4C;AACjD,MAAM/C,WAAW,GAAG,gCAAgB+C,MAAhB,EAAwBlD,GAAxB,CAApB;AACA,MAAIzG,QAAJ;AACA,MAAImM,qBAAqB,GAAG,CAA5B;AACA,MAAIC,qBAAJ;;AAEA,WAASzE,aAAT,GAAyB;AACvB,QAAIyE,qBAAqB,IAAI,IAA7B,EAAmC;AACjCA,2BAAqB;AACrBA,2BAAqB,GAAG,IAAxB;AACD;AACF;;AAID,WAASC,gBAAT,CAA0BC,SAA1B,EAAqCC,SAArC,EAAgD;AAC9C,QAAIxG,IAAI,GAAI,OAAOuG,SAAP,KAAqB,WAArB,IAAoCA,SAAS,KAAK,EAAnD,GAAyDN,kBAAzD,GAA8EM,SAAzF;AACA,QAAIE,IAAI,GAAI,OAAOD,SAAP,KAAqB,WAArB,IAAoCA,SAAS,KAAK,EAAnD,GAAyDN,kBAAzD,GAA8EM,SAAzF;AAEA,6BAAkBxG,IAAlB,SAAyByG,IAAzB;AACD;;AAED,WAASC,aAAT,CAAuBC,QAAvB,EAAiC;AAC/B,QAAIC,SAAJ;;AACA,QAAI;AACFA,eAAS,GAAG3F,IAAI,CAAC4F,KAAL,CAAWF,QAAX,CAAZ;AACD,KAFD,CAEE,OAAO7M,KAAP,EAAc;AACdC,aAAO,CAAC+M,GAAR,mDAAuDhN,KAAvD;AACD;;AACD,WAAO8M,SAAP;AACD;;AAED,WAASG,qBAAT,CAA+BC,QAA/B,EAAyC;AACvC,QAAIC,MAAM,GAAG,EAAb;AACA,QAAIC,aAAJ;AACA,QAAIC,gBAAgB,GAAGH,QAAQ,CAACC,MAAhC;AACAE,oBAAgB,CAAChJ,OAAjB,CAAyB,UAACiJ,KAAD,EAAW;AAClC,UAAIA,KAAK,CAACzO,GAAV,EAAe;AACb,YAAIqN,gBAAgB,CAAC,OAAD,CAAhB,CAA0BoB,KAAK,CAACzO,GAAN,CAAUiD,IAApC,CAAJ,EAA+C;AAC7CqL,gBAAM,CAACI,IAAP,CAAY;AACV,mBAAQrB,gBAAgB,CAAC,OAAD,CAAhB,CAA0BoB,KAAK,CAACzO,GAAN,CAAUiD,IAApC,CADE;AAEV,qBAAUwL,KAAK,CAACzO,GAAN,CAAUF;AAFV,WAAZ;AAID,SALD,MAKO;AACLsB,iBAAO,CAAC+M,GAAR,CAAY,2CAAZ;AACD;AACF,OATD,MASO,IAAIM,KAAK,CAACE,IAAV,EAAgB;AACrB,YAAItB,gBAAgB,CAAC,MAAD,CAAhB,CAAyBoB,KAAK,CAACE,IAAN,CAAW1L,IAApC,CAAJ,EAA+C;AAC7CqL,gBAAM,CAACI,IAAP,CAAY;AACV,mBAAQrB,gBAAgB,CAAC,MAAD,CAAhB,CAAyBoB,KAAK,CAACE,IAAN,CAAW1L,IAApC,CADE;AAEV,qBAAUwL,KAAK,CAACE,IAAN,CAAWxE;AAFX,WAAZ;AAID,SALD,MAKO;AACL/I,iBAAO,CAAC+M,GAAR,CAAY,yCAAZ;AACD;AACF,OATM,MASA,IAAIM,KAAK,CAACrC,KAAV,EAAiB;AACtBkC,cAAM,CAACI,IAAP,CAAY;AACV,iBAAQ,OADE;AAEV,mBAAUD,KAAK,CAACrC,KAAN,CAAYwC;AAFZ,SAAZ;AAID;AACF,KAzBD;;AA2BA,QAAIP,QAAQ,CAACQ,IAAb,EAAmB;AACjB,UAAIR,QAAQ,CAACQ,IAAT,CAAcN,aAAlB,EAAiC;AAC/BA,qBAAa,GAAGF,QAAQ,CAACQ,IAAT,CAAcN,aAA9B;AACD;;AACDD,YAAM,CAACI,IAAP,CAAY;AACV,eAAQ,UADE;AAEV,iBAAUL,QAAQ,CAACQ,IAAT,CAAc/O;AAFd,OAAZ;AAID;;AAED,WAAO;AACLwO,YAAM,EAANA,MADK;AAELC,mBAAa,EAAbA,aAFK;AAGL,qBAAgBF,QAAQ,CAACS;AAHpB,KAAP;AAKD;;AAED,WAASC,sBAAT,CAAgC1K,OAAhC,EAAyC;AACvC,QAAI2K,YAAY,GAAG,SAAfA,YAAe,CAAShB,QAAT,EAAmB;AACpC,UAAIiB,WAAW,GAAGlB,aAAa,CAACC,QAAD,CAA/B;;AACA,UAAIiB,WAAW,IAAIA,WAAW,CAACC,GAA/B,EAAoC;AAClC,YAAIhO,MAAM,GAAG6M,aAAa,CAACkB,WAAW,CAACC,GAAb,CAA1B;;AACA,YAAIhO,MAAM,IAAIA,MAAM,CAACoN,MAArB,EAA6B;AAC3B,cAAIK,IAAI,GAAGP,qBAAqB,CAAClN,MAAD,CAAhC;AACA,cAAMH,IAAI,GAAGgH,GAAG,CAACjH,QAAJ,CAAaC,IAAb,CAAkBoD,SAA/B;AACA,cAAMgL,OAAO,GAAGjN,OAAO,CAACnB,IAAD,EAAO4N,IAAP,CAAvB;AACA5G,aAAG,CAACjH,QAAJ,CAAaC,IAAb,CAAkBoD,SAAlB,GAA8BgL,OAA9B;AAEA7N,kBAAQ,IAAIA,QAAQ,CAAC;AACnB+J,yBAAa,EAAEsD,IAAI,CAACJ,aADD;AAEnBjD,uBAAW,EAAEqD,IAAI,CAACG;AAFC,WAAD,CAApB;AAID,SAVD,MAUO,CACL;AACD;AACF;AACF,KAlBD;;AAmBA,QAAI7M,IAAI,GAAGoC,OAAO,CAACpC,IAAnB;AACA,QAAIzB,KAAK,aAAMmN,gBAAgB,CAACtJ,OAAO,CAACuJ,SAAT,EAAoBvJ,OAAO,CAACwJ,SAA5B,CAAtB,mBAAqE5L,IAArE,CAAT;AACA,4BAAYzB,KAAZ,EAAmBwO,YAAnB;AACD;;AAED,WAAStD,gBAAT,CAA0BrH,OAA1B,EAAmC+G,EAAnC,EAAuC;AACrC,QAAMgE,YAAY,GAAGC,mBAAmB,EAAxC;;AACA,QAAID,YAAY,CAAC5L,MAAb,GAAsB,CAA1B,EAA6B;AAC3BlC,cAAQ,GAAG8J,EAAX;AACA2D,4BAAsB,CAAC1K,OAAD,CAAtB;AACD;AACF;AAED;;;;;;;;;AAOA,WAASsH,UAAT,CAAoB1B,IAApB,EAA0BmB,EAA1B,EAA8B;AAC5B,QAAMgE,YAAY,GAAGC,mBAAmB,CAACpF,IAAD,CAAxC;AAAA,QAAgDqF,IAAI,GAAI,OAAOvH,GAAG,CAACwH,YAAX,KAA4B,WAApF;;AAEA,QAAID,IAAI,IAAIvH,GAAG,CAACwH,YAAJ,CAAiBC,cAAjB,CAAgC,iBAAhC,CAAZ,EAAgE;AAC5DzH,SAAG,CAACwH,YAAJ,CAAiBE,eAAjB,CAAiCjK,OAAjC,CAAyC,UAACiJ,KAAD,EAAW;AAClD,YAAMhJ,GAAG,GAAIgJ,KAAK,CAACiB,KAAN,CAAY,aAAZ,CAAD,GAA+BjB,KAA/B,GAAuCtC,WAAW,CAACsC,KAAD,CAA9D;;AACA,YAAIhJ,GAAJ,EAAS;AAAC2J,sBAAY,CAACV,IAAb,CAAkBjJ,GAAlB;AAAwB;AACnC,OAHD;AAIH;;AAED,QAAI6J,IAAI,IAAIvH,GAAG,CAACwH,YAAJ,CAAiBC,cAAjB,CAAgC,kBAAhC,CAAR,IAA+DzH,GAAG,CAACwH,YAAJ,CAAiBI,gBAApF,EAAsG;AACpGrO,cAAQ,GAAG8J,EAAX;AACAsC,2BAAqB,GAAGiC,gBAAgB,CAAC1F,IAAD,CAAxC;AACD,KAHD,MAGO,IAAImF,YAAY,CAAC5L,MAAb,GAAsB,CAA1B,EAA6B;AAClClC,cAAQ,GAAG8J,EAAX;AACAsC,2BAAqB,GAAGkC,aAAa,CAAC3F,IAAD,EAAOmF,YAAP,CAArC;AACD;AACF;AAED;;;;;AAGA,WAASC,mBAAT,CAA6BpF,IAA7B,EAAmC;AACjC,QAAImF,YAAY,GAAG,EAAnB;AACA,QAAMtM,GAAG,GAAGiF,GAAG,CAACjH,QAAhB;AACA,QAAMwO,IAAI,GAAI,OAAOvH,GAAG,CAACwH,YAAX,KAA4B,WAA1C;AAEArK,UAAM,CAACC,IAAP,CAAYgH,WAAZ,EAAyB3G,OAAzB,CAAiC,UAAAC,GAAG,EAAI;AACtC,UAAMoK,cAAc,GAAG1D,WAAW,CAAC1G,GAAD,CAAlC;AACA,UAAMqK,WAAW,GAAI7F,IAAI,IAAI,CAACqF,IAAV,aAAqBO,cAArB,cAAuC5F,IAAvC,cAAmD4F,cAAnD,CAApB;AACA,UAAME,gBAAgB,GAAI,CAACjN,GAAG,CAAC/B,IAAJ,CAASoD,SAAT,CAAmB6L,OAAnB,CAA2BF,WAA3B,CAAF,GAA6ChN,GAAG,CAAC/B,IAAJ,CAASoD,SAAT,CAAmB6L,OAAnB,CAA2BF,WAA3B,CAA7C,GAAwFhN,GAAG,CAACmN,IAAJ,CAAS9L,SAAT,IAAsBrB,GAAG,CAACmN,IAAJ,CAAS9L,SAAT,CAAmB6L,OAAnB,CAA2BF,WAA3B,CAAvI;;AAEA,UAAI,CAACC,gBAAL,EAAuB;AACrBX,oBAAY,CAACV,IAAb,CAAkBmB,cAAlB;AACD;AACF,KARD;AAUA,WAAOT,YAAP;AACD;AAED;;;;;;AAIA,WAASQ,aAAT,CAAuB3F,IAAvB,EAA6BqE,MAA7B,EAAqC;AACnC,QAAMnG,OAAO,GAAG;AACdA,aAAO,EAAE,eADK;AAEd0C,YAAM,EAAE,cAFM;AAGdZ,UAAI,EAAJA,IAHc;AAIdqE,YAAM,EAANA;AAJc,KAAhB;AAOA,WAAOpG,WAAW,CAACC,OAAD,EAAU+H,aAAV,CAAlB;AACD;AAED;;;;;;AAIA,WAASP,gBAAT,CAA0B1F,IAA1B,EAAgC;AAC9B,QAAM9B,OAAO,GAAG;AACdA,aAAO,EAAE,eADK;AAEd0C,YAAM,EAAE,iBAFM;AAGdZ,UAAI,EAAJA;AAHc,KAAhB;AAKA,WAAO/B,WAAW,CAACC,OAAD,EAAU+H,aAAV,CAAlB;AACD;AAED;;;;;AAGA,WAASC,mBAAT,CAA6BlG,IAA7B,EAAmCvJ,MAAnC,EAA2C;AACzC,QAAMyH,OAAO,GAAG;AACdA,aAAO,EAAE,eADK;AAEd0C,YAAM,EAAE,oBAFM;AAGdZ,UAAI,EAAJA,IAHc;AAIdvJ,YAAM,EAANA;AAJc,KAAhB;AAMAwH,eAAW,CAACC,OAAD,CAAX;AACD;AAED;;;;;AAGA,WAAS+H,aAAT,CAAuB3F,KAAvB,EAA8B;AAC5B,QAAIoE,IAAI,GAAG,EAAX;;AAEA,QAAI;AACFA,UAAI,GAAGrG,IAAI,CAAC4F,KAAL,CAAW3D,KAAK,CAACoE,IAAjB,CAAP;AACD,KAFD,CAEE,OAAO1C,CAAP,EAAU;AACV,UAAIwB,qBAAqB,KAAK,EAA9B,EAAkC;AAChC;;;;AAIAxE,qBAAa;AACd;;AACD;AACD;;AAED,QAAI0F,IAAI,CAACxG,OAAL,KAAiB,eAArB,EAAsC;AACpC,UAAMpH,IAAI,GAAGgH,GAAG,CAACjH,QAAJ,CAAaC,IAAb,CAAkBoD,SAA/B;AACA,UAAM8L,IAAI,GAAGlI,GAAG,CAACjH,QAAJ,CAAamP,IAAb,CAAkB9L,SAA/B;AACA,UAAMmL,IAAI,GAAI,OAAOvH,GAAG,CAACwH,YAAX,KAA4B,WAA1C;AAEA,UAAID,IAAI,IAAIX,IAAI,CAAC1E,IAAL,KAAclC,GAAG,CAACwH,YAAJ,CAAiBtF,IAA3C,EAAiD;AAEjD,UAAIgG,IAAJ,EAAUlI,GAAG,CAACjH,QAAJ,CAAamP,IAAb,CAAkB9L,SAAlB,GAA8BjC,OAAO,CAAC+N,IAAD,EAAOtB,IAAP,CAArC;AAEV,UAAIyB,aAAa,GAAGzB,IAAI,CAACL,MAAzB;;AACA,UAAIK,IAAI,CAAC0B,IAAT,EAAe;AACbD,qBAAa,GAAGzB,IAAI,CAAC0B,IAArB;;AACA/O,gBAAQ,GAAG,oBAAM;AACf,sEAA6BqN,IAAI,CAAC0B,IAAlC;AACA,iEAAwB1B,IAAI,CAAC0B,IAA7B;AACD,SAHD;AAID;;AAED,UAAK1B,IAAI,CAACa,cAAL,CAAoB,aAApB,KAAsCb,IAAI,CAACvB,WAA5C,IAA6DkC,IAAI,IAAIvH,GAAG,CAACwH,YAAJ,CAAiBC,cAAjB,CAAgC,aAAhC,CAAzE,EAA0H;AACxH,YAAIzH,GAAG,CAACuI,QAAR,EAAkB;AAChB,cAAMnB,OAAO,GAAIpH,GAAG,CAACuI,QAAJ,IAAgBvI,GAAG,CAACuI,QAAJ,CAAaF,aAAb,CAAjB,IAAiD,EAAjE;AAEAE,kBAAQ,CAACnB,OAAD,EAAUR,IAAV,CAAR;AACD,SAJD,MAIO,IAAI7N,QAAQ,CAACyP,cAAT,CAAwB,oBAAxB,CAAJ,EAAmD;AACxDzP,kBAAQ,CAACyP,cAAT,CAAwB,oBAAxB,EAA8CrQ,gBAA9C,CAA+D,MAA/D,EAAuE,YAAW;AAChF,gBAAMiP,OAAO,GAAIpH,GAAG,CAACuI,QAAJ,IAAgBvI,GAAG,CAACuI,QAAJ,CAAaF,aAAb,CAAjB,IAAiD,EAAjE;AAEAE,oBAAQ,CAACnB,OAAD,EAAUR,IAAV,CAAR;AACD,WAJD;AAKD,SANM,MAMA;AACL,iCAAW5G,GAAX,EAAkBuH,IAAI,IAAIvH,GAAG,CAACwH,YAAJ,CAAiBC,cAAjB,CAAgC,aAAhC,CAAR,IAA0DzH,GAAG,CAACwH,YAAJ,CAAiBnC,WAA5E,IAA4FuB,IAAI,CAACvB,WAAlH,EAAgI,YAAW;AACzI,gBAAM+B,OAAO,GAAIpH,GAAG,CAACuI,QAAJ,IAAgBvI,GAAG,CAACuI,QAAJ,CAAaF,aAAb,CAAjB,IAAiD,EAAjE;AAEAE,oBAAQ,CAACnB,OAAD,EAAUR,IAAV,CAAR;AACD,WAJD;AAKD;AACF,OAlBD,MAkBO,IAAKA,IAAI,CAACa,cAAL,CAAoB,YAApB,KAAqCb,IAAI,CAAC6B,UAA3C,IAAyDlB,IAAI,IAAIvH,GAAG,CAACwH,YAAJ,CAAiBC,cAAjB,CAAgC,YAAhC,CAArE,EAAqH;AAC1H,YAAMiB,QAAQ,GAAKnB,IAAI,IAAIvH,GAAG,CAACwH,YAAJ,CAAiBC,cAAjB,CAAgC,YAAhC,CAAR,IAAyDzH,GAAG,CAACwH,YAAJ,CAAiBiB,UAA3E,IAA0F7B,IAAI,CAAC6B,UAAjH;;AACA,YAAMrB,QAAO,GAAGjN,OAAO,CAACuO,QAAD,EAAW9B,IAAX,CAAvB;;AAEA2B,gBAAQ,CAACnB,QAAD,EAAUR,IAAV,CAAR;AACD,OALM,MAKA;AACL,YAAMQ,SAAO,GAAGjN,OAAO,CAACnB,IAAD,EAAO4N,IAAP,CAAvB;;AAEA5G,WAAG,CAACjH,QAAJ,CAAaC,IAAb,CAAkBoD,SAAlB,GAA8BgL,SAA9B;AACA7N,gBAAQ,IAAIA,QAAQ,EAApB;AACA2H,qBAAa;AACd;AACF;AACF;AAED;;;AACA,WAASyH,wBAAT,CAAkC3I,GAAlC,EAAuC;AACrC,QAAIrF,aAAa,GAAGqF,GAApB;AACA,QAAI4I,mBAAJ;;AAEA,WAAOjO,aAAa,KAAKqF,GAAG,CAAC6I,GAA7B,EAAkC;AAC9BD,yBAAmB,GAAGjO,aAAa,CAAC+F,MAApC;AACA,UAAI,CAACkI,mBAAmB,CAACE,MAArB,IAA+B,CAACF,mBAAmB,CAACE,MAApB,CAA2BrN,MAA/D,EAAuE,OAAO,IAAP;;AACvE,WAAK,IAAIsN,GAAG,GAAG,CAAf,EAAkBA,GAAG,GAAGH,mBAAmB,CAACE,MAApB,CAA2BrN,MAAnD,EAA2DsN,GAAG,EAA9D;AACI,YAAIH,mBAAmB,CAACE,MAApB,CAA2BC,GAA3B,MAAoCpO,aAAxC,EAAuD;AACrD,cAAI,CAACiO,mBAAmB,CAAC7P,QAAzB,EAAmC,OAAO,IAAP;AADkB;AAAA;AAAA;;AAAA;AAEnD,iCAAyB6P,mBAAmB,CAAC7P,QAApB,CAA6ByC,oBAA7B,CAAkD,QAAlD,CAAzB,8HAAsF;AAAA,kBAA7EwN,YAA6E;AAClF,kBAAI,CAACA,YAAY,CAACC,aAAlB,EAAiC,OAAO,IAAP;;AACjC,kBAAID,YAAY,CAACC,aAAb,KAA+BtO,aAAnC,EAAkD;AAC9C,uBAAOqO,YAAY,CAACE,aAApB;AACH;AACJ;AAPkD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQtD;AATL;AAUH;AACJ;;AAEC,WAASX,QAAT,CAAkBY,IAAlB,EAAwBtN,GAAxB,EAA6B;AAC3B;AACA;AACA;AACA;AACA,QAAI,CAACsI,UAAU,CAACiF,WAAX,EAAL,EAA+B;AAC7B,UAAIC,eAAe,GAAGV,wBAAwB,CAAC3I,GAAD,CAA9C;;AACA,UAAIqJ,eAAJ,EAAqB;AACnB,YAAI3Q,KAAK,GAAI2Q,eAAe,CAACC,qBAAhB,GAAwC5Q,KAArD;AACAsH,WAAG,CAACjH,QAAJ,CAAaC,IAAb,CAAkBuQ,KAAlB,CAAwB7Q,KAAxB,aAAmCA,KAAnC;AACD;AACF;;AACDsH,OAAG,CAACjH,QAAJ,CAAaC,IAAb,CAAkBoD,SAAlB,IAA+B+M,IAA/B;AACA5P,YAAQ,IAAIA,QAAQ,EAApB;AACAyG,OAAG,CAACmB,mBAAJ,CAAwB,SAAxB,EAAmCgH,aAAnC;AACAjH,iBAAa;AACbkH,uBAAmB,CAACvM,GAAG,CAACqG,IAAL,EAAYnJ,QAAQ,CAACC,IAAT,CAAcwQ,YAAd,IAA8BzQ,QAAQ,CAACC,IAAT,CAAcyQ,YAAxD,CAAnB;;AAEA,QAAI,OAAOlK,MAAM,CAACmK,YAAd,KAA+B,UAAnC,EAA+C;AAC7CnK,YAAM,CAACmK,YAAP,CAAoB7N,GAApB;AACD;AACF;;AAED,WAAS8N,yBAAT,CAAmCR,IAAnC,EAAyCb,IAAzC,EAA+C;AAC7C,QAAMsB,aAAa,GAAG,SAAhBA,aAAgB,CAAClD,KAAD,EAAW;AAC/B,UAAIA,KAAK,CAACzO,GAAV,EAAe;AACb,eAAOyO,KAAK,CAACzO,GAAN,CAAUF,GAAjB;AACD;;AACD,UAAI2O,KAAK,CAACE,IAAV,EAAgB;AACd,eAAOF,KAAK,CAACE,IAAN,CAAWxE,KAAlB;AACD;;AACD,UAAIsE,KAAK,CAACrC,KAAV,EAAiB;AACf,eAAOqC,KAAK,CAACrC,KAAN,CAAYwC,IAAnB;AACD;;AACD,UAAIH,KAAK,CAACmD,KAAV,EAAiB;AACf,eAAOnD,KAAK,CAACmD,KAAN,CAAYC,OAAnB;AACD;AACF,KAbD;;AAeAxB,QAAI,CAAC/B,MAAL,CAAY9I,OAAZ,CAAoB,UAAAiJ,KAAK,EAAI;AAC3ByC,UAAI,GAAGA,IAAI,CAAChP,OAAL,gCAAqCuM,KAAK,CAACqD,EAA3C,SAAmDH,aAAa,CAAClD,KAAD,CAAhE,CAAP;;AACA,UAAIA,KAAK,CAACI,IAAN,IAAcJ,KAAK,CAACI,IAAN,CAAW/O,GAA7B,EAAkC;AAChCoR,YAAI,GAAGA,IAAI,CAAChP,OAAL,qCAA0CuM,KAAK,CAACqD,EAAhD,SAAwDrD,KAAK,CAACI,IAAN,CAAW/O,GAAnE,CAAP;AACD;AACF,KALD;;AAOA,QAAIuQ,IAAI,CAAC0B,OAAT,EAAkB;AAChBb,UAAI,GAAGA,IAAI,CAAChP,OAAL,CAAa,uBAAb,EAAsCmO,IAAI,CAAC0B,OAA3C,CAAP;AACD;;AAED,QAAI1B,IAAI,CAACxB,IAAT,EAAe;AACbqC,UAAI,GAAGA,IAAI,CAACc,UAAL,CAAgB,uBAAhB,EAAyC3B,IAAI,CAACxB,IAAL,CAAU/O,GAAnD,CAAP;AACD;;AAED,WAAOoR,IAAP;AACD;AAED;;;;;;AAIA,WAAShP,OAAT,CAAiBpB,QAAjB,EAA2B6N,IAA3B,EAAiC;AAC/B,QAAIuC,IAAI,GAAGpQ,QAAX;;AACA,QAAI6N,IAAI,CAAC0B,IAAT,EAAe;AACb,aAAOqB,yBAAyB,CAACR,IAAD,EAAOvC,IAAI,CAAC0B,IAAZ,CAAhC;AACD,KAFD,MAEO,IAAI,CAAC3K,KAAK,CAACC,OAAN,CAAcgJ,IAAI,CAACL,MAAnB,CAAL,EAAiC;AACtC,aAAO4C,IAAP;AACD;;AAED,QAAI5C,MAAM,GAAGK,IAAI,CAACL,MAAlB;AACA,QAAIrE,IAAI,GAAG0E,IAAI,CAAC1E,IAAhB;AAEAqE,UAAM,CAAC9I,OAAP,CAAe,UAAAiJ,KAAK,EAAI;AACtB,UAAMa,IAAI,GAAI,OAAOvH,GAAG,CAACwH,YAAX,KAA4B,WAA1C;AACA,UAAM0C,YAAY,GAAIhI,IAAI,IAAI,CAACqF,IAAV,aAAqBnD,WAAW,CAACsC,KAAK,CAAChJ,GAAP,CAAhC,cAA+CwE,IAA/C,IAA0DqF,IAAD,GAAS,iBAAQnD,WAAW,CAACsC,KAAK,CAAChJ,GAAP,CAAnB,IAAiC,IAA1C,aAAoD0G,WAAW,CAACsC,KAAK,CAAChJ,GAAP,CAA/D,CAA9E;AACA,UAAMyM,iBAAiB,GAAG,IAAIC,MAAJ,CAAWF,YAAX,EAAyB,GAAzB,CAA1B;AACAf,UAAI,GAAGA,IAAI,CAAChP,OAAL,CAAagQ,iBAAb,EAAgCzD,KAAK,CAACtE,KAAtC,CAAP;AACD,KALD;AAOA,WAAO+G,IAAP;AACD;;AAED,SAAO;AACLvF,cAAU,EAAVA,UADK;AAELD,oBAAgB,EAAhBA;AAFK,GAAP;AAID,C;;;;;;;;;;;;;;;ACxbD;;AAEA,IAAMjC,oBAAoB,GAAG,UAA7B;AACA,IAAM2I,0BAA0B,GAAG,oBAAnC;;AAEO,SAASC,4BAAT,CAAsChC,IAAtC,EAA4C;AAC/C,MAAMiC,aAAa,GAAGjC,IAAI,CAACkC,aAAL,IAAsB,EAA5C,CAD+C,CAE/C;;AACA,MAAMC,kBAAkB,GAAGF,aAAa,CAACG,MAAd,CAAqB,UAAAC,OAAO;AAAA,WAAIA,OAAO,CAACnI,KAAR,KAAkB,CAAtB;AAAA,GAA5B,CAA3B,CAH+C,CAK/C;;AACA,MAAIoI,gBAAgB,GAAGH,kBAAkB,CAACC,MAAnB,CAA0B,UAAAtJ,EAAE;AAAA,WAAIA,EAAE,CAACyJ,MAAH,IAAa,CAAjB;AAAA,GAA5B,EAAgDC,GAAhD,CAAoD,UAAA5G,CAAC;AAAA,WAAIA,CAAC,CAACnM,GAAN;AAAA,GAArD,CAAvB,CAN+C,CAO/C;;AACA,MAAIgT,eAAe,GAAGN,kBAAkB,CAACC,MAAnB,CAA0B,UAAAtJ,EAAE;AAAA,WAAIA,EAAE,CAACyJ,MAAH,IAAa,CAAjB;AAAA,GAA5B,EAAgDC,GAAhD,CAAoD,UAAA5G,CAAC;AAAA,WAAIA,CAAC,CAACnM,GAAN;AAAA,GAArD,CAAtB;AAEA6S,kBAAgB,CAACnN,OAAjB,CAAyB,UAAA1F,GAAG;AAAA,WAAI,yBAAaA,GAAb,CAAJ;AAAA,GAA5B;AACAgT,iBAAe,CAACtN,OAAhB,CAAwB,UAAA1F,GAAG;AAAA,WAAI,uBAAWwH,MAAX,EAAmBxH,GAAnB,CAAJ;AAAA,GAA3B;AACH;;AAEM,SAASiT,uBAAT,CAAiC1C,IAAjC,EAAuC;AAC1C,MAAMvG,UAAU,GAAGhJ,QAAQ,CAACiJ,sBAAT,CAAgCN,oBAAhC,KAAyD,EAA5E,CAD0C,CAE1C;;AACA,MAAMuJ,cAAc,GAAG3C,IAAI,CAAC/B,MAAL,CAAYmE,MAAZ,CAAmB,UAAAQ,CAAC;AAAA,WAAIA,CAAC,CAACpE,IAAN;AAAA,GAApB,EAAgCqE,MAAhC,CAAuC,UAACL,GAAD,EAAMpE,KAAN;AAAA,WAAiBoE,GAAG,CAACpE,KAAK,CAACqD,EAAP,CAAH,GAAgBrD,KAAK,CAACI,IAAtB,EAA4BgE,GAA7C;AAAA,GAAvC,EAA0F,EAA1F,CAAvB;AACA,MAAMM,mBAAmB,GAAG9C,IAAI,CAACxB,IAAL,CAAUN,aAAV,IAA2B,EAAvD;;AACA,OAAK,IAAI7D,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGZ,UAAU,CAACtG,MAA/B,EAAuCkH,CAAC,EAAxC,EAA4C;AACxCZ,cAAU,CAACY,CAAD,CAAV,CAAcxK,gBAAd,CAA+B,OAA/B,EAAwC,UAACqK,KAAD,EAAW;AAC/C,UAAI6I,aAAa,GAAG7I,KAAK,CAACyB,MAA1B,CAD+C,CAE/C;;AACA,UAAIqH,OAAO,GAAGD,aAAa,IAAIA,aAAa,CAACE,YAAd,CAA2BlB,0BAA3B,CAA/B;AACA,UAAImB,SAAS,GAAGP,cAAc,CAACK,OAAD,CAA9B;AACA,UAAIhI,aAAa,GAAG8H,mBAApB,CAL+C,CAM/C;;AACA,UAAII,SAAJ,EAAe;AACXlI,qBAAa,GAAGkI,SAAS,CAAChF,aAAV,IAA2B,EAA3C;AACH;;AACDlD,mBAAa,CAAC7F,OAAd,CAAsB,UAAA1F,GAAG;AAAA,eAAI,yBAAaA,GAAb,CAAJ;AAAA,OAAzB;AACH,KAXD,EAWG,IAXH;AAYH;AACJ,C;;;;;;;;;;;;;;ACtCD;;;;AAIA;;;;;;;AASO,SAAS0T,cAAT,CAAwBzL,GAAxB,EAA6B;AAClC;;;;AAIA,WAAS0L,KAAT,CAAexR,IAAf,EAAqB;AACnB;AACA;AACA,WAAO,OAAOA,IAAP,KAAgB,QAAhB,IAA4BA,IAAI,KAAK,EAArC,IAA2CyR,aAAa,EAA/D;AACD;AAED;;;;;AAGA,WAASvC,WAAT,GAAuB;AACrB,WAAO,CAAC,EAAEpJ,GAAG,CAAC4L,GAAJ,IAAW5L,GAAG,CAAC4L,GAAJ,CAAQC,GAArB,CAAR;AACD;AAED;;;;;;AAIA,WAASF,aAAT,GAAyB;AACvB,WAAO3L,GAAG,CAAC6I,GAAJ,KAAY7I,GAAZ,IAAmB,CAAC8L,gBAAgB,CAAC9L,GAAD,CAA3C;AACD;AAED;;;;;;;;;AAOA,WAAS8L,gBAAT,CAA0B9L,GAA1B,EAA+B;AAC7B,QAAI;AACF;AACAA,SAAG,CAAC6I,GAAJ,CAAQrJ,QAAR,CAAiB/E,QAAjB;AACA,aAAO,IAAP;AACD,KAJD,CAIE,OAAOyJ,CAAP,EAAU;AACV,aAAO,KAAP;AACD;AACF;AAED;;;;;;;AAKA,WAAS6H,eAAT,GAA2B;AACzB,QAAIC,MAAM,GAAG,KAAb;AACA,QAAIrR,aAAa,GAAGqF,GAApB;;AAEA,WAAO,CAACgM,MAAR,EAAgB;AACd,UAAI;AACF,YAAIrR,aAAa,CAACsR,IAAlB,EAAwB;AACtBD,gBAAM,GAAG,IAAT;AACA;AACD;AACF,OALD,CAKE,OAAO9H,CAAP,EAAU,CAAG;;AACf,UAAIvJ,aAAa,KAAK4E,MAAM,CAACsJ,GAA7B,EAAkC;AAElClO,mBAAa,GAAGA,aAAa,CAAC+F,MAA9B;AACD;;AACD,WAAOsL,MAAP;AACD;AAED;;;;;;AAIA,WAASE,WAAT,CAAqB9I,GAArB,EAA0B;AACxB,WAAOA,GAAG,IAAIA,GAAG,KAAK,YAAtB;AACD;;AAED,SAAO;AACL8I,eAAW,EAAXA,WADK;AAELP,iBAAa,EAAbA,aAFK;AAGLvC,eAAW,EAAXA,WAHK;AAILsC,SAAK,EAALA,KAJK;AAKLK,mBAAe,EAAfA;AALK,GAAP;AAOD,C","file":"native-trk.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 054deb7ab036aadc5171","const postscribe = require('postscribe');\nimport * as domHelper from './domHelper';\n\n/**\n * Inserts an image pixel with the specified `url` for cookie sync\n * @param {string} url URL string of the image pixel to load\n * @param  {function} [done] an optional exit callback, used when this usersync pixel is added during an async process\n */\nexport function triggerPixel(url, done) {\n  const img = new Image();\n  if (done && typeof done === 'function') {\n    img.addEventListener('load', done);\n    img.addEventListener('error', done);\n  }\n  img.src = url;\n}\n\nexport function createTrackPixelHtml(url) {\n  if (!url) {\n    return '';\n  }\n\n  let escapedUrl = encodeURI(url);\n  let img = `<div style=\"position:absolute;left:0px;top:0px;visibility:hidden;\"><img src=\"${escapedUrl}\"></div>`;\n  return img;\n}\n\nexport function writeAdUrl(adUrl, width, height) {\n  let iframe = domHelper.getEmptyIframe(height, width);\n  iframe.src = adUrl;\n  document.body.appendChild(iframe);\n}\n\nexport function writeAdHtml(markup) {\n  postscribe(document.body, markup, {\n    error: console.error\n  });\n}\n\nexport function sendRequest(url, callback) {\n  function reqListener() {\n    callback(oReq.responseText);\n  }\n\n  let oReq = new XMLHttpRequest();\n  oReq.addEventListener('load', reqListener);\n  oReq.open('GET', url);\n  oReq.send();\n}\n\nexport function getUUID() {\n  let d = new Date().getTime();\n  let uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    let r = (d + Math.random() * 16) % 16 | 0;\n    d = Math.floor(d / 16);\n    return (c === 'x' ? r : (r & 0x3 | 0x8)).toString(16);\n  });\n  return uuid;\n};\n\nexport function loadScript(currentWindow, tagSrc, successCallback, errorCallback) {\n  let doc = currentWindow.document;\n  let scriptTag = doc.createElement('script');\n  scriptTag.type = 'text/javascript';\n\n  // Execute success callback if necessary\n  if (successCallback && typeof successCallback === 'function') {\n    if (scriptTag.readyState) {\n      scriptTag.onreadystatechange = function() {\n        if (scriptTag.readyState === 'loaded' || scriptTag.readyState === 'complete') {\n          scriptTag.onreadystatechange = null;\n          successCallback();\n        }\n      };\n    } else {\n      scriptTag.onload = function() {\n        successCallback();\n      };\n    }\n  }\n\n  // Execute error callback if necessary\n  if (errorCallback && typeof errorCallback === 'function') {\n    scriptTag.onerror = function() {\n      errorCallback();\n    };\n  }\n\n  scriptTag.src = tagSrc;\n\n  //add the new script tag to the page\n  let elToAppend = doc.getElementsByTagName('head');\n  elToAppend = elToAppend.length ? elToAppend : doc.getElementsByTagName('body');\n  if (elToAppend.length) {\n    elToAppend = elToAppend[0];\n    elToAppend.insertBefore(scriptTag, elToAppend.firstChild);\n  }\n\n  return scriptTag;\n};\n\n/**\n * Return comment element\n * @param {*} bid\n */\nexport function getCreativeComment(bid) {\n  return document.createComment(`Creative ${bid.crid} served by Prebid.js Header Bidding`);\n}\n\n/**\n * Returns comment element markup\n * @param {*} bid\n */\nexport function getCreativeCommentMarkup(bid) {\n  let creativeComment = exports.getCreativeComment(bid);\n  let wrapper = document.createElement('div');\n  wrapper.appendChild(creativeComment);\n  return wrapper.innerHTML;\n}\n\nexport function transformAuctionTargetingData(tagData) {\n  // this map object translates the Prebid.js auction keys to their equivalent Prebid Universal Creative keys\n  // when the publisher uses their adserver's generic macro that provides all targeting keys (ie tagData.targetingMap), we need to convert the keys\n  const auctionKeyMap = {\n    hb_adid: 'adId',\n    hb_cache_host: 'cacheHost',\n    hb_cache_path: 'cachePath',\n    hb_cache_id: 'uuid',\n    hb_format: 'mediaType',\n    hb_env: 'env',\n    hb_size: 'size',\n    hb_pb: 'hbPb'\n  };\n\n  /**\n   * Determine if the supplied property of the tagData object exists and is populated with its own values/properties according to its type\n   * @param {string} paramName name of the property to check (eg tagData.targetingMap)\n   * @returns true/false\n   */\n  function isMacroPresent(paramName) {\n    return !!(\n      tagData[paramName] && (\n        (isPlainObject(tagData[paramName]) && Object.keys(tagData[paramName]).length > 0) ||\n        (isStr(tagData[paramName]) && tagData[paramName] !== '')\n      )\n    );\n  }\n\n  /**\n   * Converts the specifically formatted object of keypairs to a more generalized structure\n   * It specifically extracts the keyvalue from an array and stores it as a normal string\n   * @param {object} tarMap object of keys with the keyvalue stored in an array; eg {\"hb_adid\":[\"26566ee8c7f251\"], ...}\n   * @returns {object} result is an object map like the following: {\"hb_cache_id\":\"123456\", \"other_key\":\"other_value\", ...}\n   */\n  function convertTargetingMapToNormalMap(tarMap) {\n    let newTarMap = {};\n\n    Object.keys(tarMap).forEach(function(key) {\n      if (Array.isArray(tarMap[key]) && tarMap[key].length > 0) {\n        newTarMap[key] = tarMap[key][0];\n      }\n    });\n    return newTarMap;\n  }\n\n  /**\n   * Converts a specifically formatted string of keypairs to a specifically formatted object map\n   * @param {String} keywordsStr string of keypairs; eg \"hb_cache_id:123456,other_key:other_value\"\n   * @returns {object} result is an object map like the following: {\"hb_cache_id\":\"123456\", \"other_key\":\"other_value\", ...}\n   */\n  function convertKeyPairStringToMap(keywordsStr) {\n    let keywordsMap = {};\n    const keywordsArr = keywordsStr.split(',');\n\n    if (keywordsArr.length > 0) {\n      keywordsArr.forEach(function(keyPairStr) {\n        let keyPairArr = keyPairStr.split(':');\n        if (keyPairArr.length === 2) {\n          let k = keyPairArr[0];\n          let v = keyPairArr[1];\n          keywordsMap[k] = v;\n        }\n      });\n    }\n    return keywordsMap;\n  }\n\n  /**\n   * Rename key if it's part of the auctionKeyMap object; if not, leave key as is\n   * Store the resultant keypair in the auctionData object for later use in renderingManager.renderAd()\n   * @param {object} adServerKeyMap incoming object map of the auction keys from the UC tag; eg {'key1':'value1', 'key2':'value2', ...}\n   */\n  function renameKnownAuctionKeys(adServerKeyMap) {\n    Object.keys(adServerKeyMap).forEach(function(key) {\n      let internalKey = auctionKeyMap[key] || key;\n      auctionData[internalKey] = adServerKeyMap[key];\n    });\n  }\n\n  let auctionData = {};\n  let formattedKeyMap = {};\n\n  if (isMacroPresent('targetingMap')) {\n    formattedKeyMap = convertTargetingMapToNormalMap(tagData.targetingMap);\n  } else if (isMacroPresent('targetingKeywords')) {\n    formattedKeyMap = convertKeyPairStringToMap(tagData.targetingKeywords);\n  }\n  renameKnownAuctionKeys(formattedKeyMap);\n\n  // set keys not in defined map macros (eg targetingMap) and/or the keys setup within a non-DFP adserver\n  Object.keys(tagData).forEach(function (key) {\n    if (key !== 'targetingMap' && key !== 'targetingKeywords' && isStr(tagData[key]) && tagData[key] !== '') {\n      auctionData[key] = tagData[key];\n    }\n  });\n  return auctionData;\n}\n\nexport function parseUrl(url) {\n  let parsed = document.createElement('a');\n\n  parsed.href = decodeURIComponent(url);\n\n  return {\n    href: parsed.href,\n    protocol: (parsed.protocol || '').replace(/:$/, ''),\n    hostname: parsed.hostname,\n    port: +parsed.port,\n    pathname: parsed.pathname.replace(/^(?!\\/)/, '/'),\n    hash: (parsed.hash || '').replace(/^#/, ''),\n    host: (parsed.host || window.location.host).replace(/:(443|80)$/, '')\n  };\n}\n\nfunction isA(object, _t) {\n  return Object.prototype.toString.call(object) === '[object ' + _t + ']';\n};\n\nfunction isPlainObject(object) {\n  return isA(object, 'Object');\n}\n\nfunction isStr(object) {\n  return isA(object, 'String');\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils.js","import {parseUrl} from './utils.js';\n\nexport function prebidMessenger(publisherURL, win = window) {\n    const prebidDomain = (() => {\n        if (publisherURL == null) {\n            return null;\n        }\n        const parsedUrl = parseUrl(publisherURL);\n        return parsedUrl.protocol + '://' + parsedUrl.host;\n    })();\n\n    return function sendMessage(message, onResponse) {\n        if (prebidDomain == null) {\n            throw new Error('Missing pubUrl')\n        }\n        message = JSON.stringify(message);\n        let messagePort;\n        if (onResponse == null) {\n            win.parent.postMessage(message, prebidDomain);\n        } else {\n            const channel = new MessageChannel();\n            messagePort = channel.port1;\n            messagePort.onmessage = onResponse;\n            win.addEventListener('message', windowListener);\n            win.parent.postMessage(message, prebidDomain, [channel.port2]);\n        }\n\n        return function stopListening() {\n            if (messagePort != null) {\n                win.removeEventListener('message', windowListener);\n                messagePort.onmessage = null;\n                messagePort = null;\n            }\n        }\n\n        function windowListener(ev) {\n            if ((ev.origin || (ev.originalEvent && ev.originalEvent.origin)) === prebidDomain) {\n                onResponse(ev);\n            }\n        }\n\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/messaging.js","import { newNativeTrackerManager } from './nativeTrackerManager';\n\nwindow.pbNativeTag = (window.pbNativeTag || {});\nconst nativeTrackerManager = newNativeTrackerManager(window);\n\nwindow.pbNativeTag.startTrackers = nativeTrackerManager.startTrackers;\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/nativeTrackers.js","/*\n * Script to handle firing impression and click trackers from native teamplates\n */\nimport { parseUrl, triggerPixel, transformAuctionTargetingData } from './utils';\nimport { newNativeAssetManager } from './nativeAssetManager';\nimport {prebidMessenger} from './messaging.js';\n\nconst AD_ANCHOR_CLASS_NAME = 'pb-click';\nconst AD_DATA_ADID_ATTRIBUTE = 'pbAdId';\n\nexport function newNativeTrackerManager(win) {\n  let sendMessage;\n\n  function findAdElements(className) {\n    let adElements = win.document.getElementsByClassName(className);\n    return adElements || [];\n  }\n\n  function readAdIdFromElement(adElements) {\n    let adId = (adElements.length > 0) &&\n      adElements[0].attributes &&\n      adElements[0].attributes[AD_DATA_ADID_ATTRIBUTE] &&\n      adElements[0].attributes[AD_DATA_ADID_ATTRIBUTE].value;\n    return adId || '';\n  }\n\n  function readAdIdFromSingleElement(adElement) {\n    let adId =  adElement.attributes &&\n      adElement.attributes[AD_DATA_ADID_ATTRIBUTE] &&\n      adElement.attributes[AD_DATA_ADID_ATTRIBUTE].value;\n    return adId || '';\n  }\n\n  function loadClickTrackers(event, adId) {\n    fireTracker(adId, 'click');\n  }\n\n  function loadImpTrackers(adElements) {\n      for(var i = 0; i < adElements.length; i++){\n          let adId = readAdIdFromSingleElement(adElements[i]);\n          fireTracker(adId, 'impression');\n      }\n  }\n\n  function attachClickListeners(adElements, listener = loadClickTrackers) {\n    adElements = adElements || findAdElements(AD_ANCHOR_CLASS_NAME);\n\n    for (let i = 0; i < adElements.length; i++) {\n      let adId = readAdIdFromSingleElement(adElements[i]);\n      adElements[i].addEventListener('click', function(event) {\n        listener(event, adId);\n      }, true);\n    }\n  }\n\n  function fireTracker(adId, action) {\n    if (adId === '') {\n      console.warn('Prebid tracking event was missing \\'adId\\'.  Was adId macro set in the HTML attribute ' + AD_DATA_ADID_ATTRIBUTE + 'on the ad\\'s anchor element');\n    } else {\n      let message = { message: 'Prebid Native', adId: adId };\n\n      // fires click trackers when called via link\n      if (action === 'click') {\n        message.action = 'click';\n      }\n\n      sendMessage(message);\n    }\n  }\n\n  // START OF MAIN CODE\n  let startTrackers = function (dataObject) {\n    const targetingData = transformAuctionTargetingData(dataObject);\n    sendMessage = prebidMessenger(targetingData.pubUrl, win);\n    const nativeAssetManager = newNativeAssetManager(window, targetingData.pubUrl);\n\n    if (targetingData && targetingData.env === 'mobile-app') {\n      let cb = function({clickTrackers, impTrackers} = {}) {\n        function loadMobileClickTrackers(clickTrackers) {\n          (clickTrackers || []).forEach(triggerPixel);\n        }\n        const boundedLoadMobileClickTrackers = loadMobileClickTrackers.bind(null, clickTrackers);\n        attachClickListeners(false, boundedLoadMobileClickTrackers);\n\n        (impTrackers || []).forEach(triggerPixel);\n      }\n      nativeAssetManager.loadMobileAssets(targetingData, cb);\n    } else {\n      let adElements = findAdElements(AD_ANCHOR_CLASS_NAME);\n\n      nativeAssetManager.loadAssets(\n        readAdIdFromElement(adElements),\n        attachClickListeners\n      );\n\n      attachClickListeners(adElements, loadClickTrackers);\n\n      // fires native impressions on creative load\n      if (adElements.length > 0) {\n        loadImpTrackers(adElements);\n      }\n    }\n  }\n\n  return {\n    startTrackers\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/nativeTrackerManager.js","/**\n * domHelper: a collection of helpful dom things\n */\n\n\n/**\n * returns a empty iframe element with specified height/width\n * @param {Number} height height iframe set to \n * @param {Number} width width iframe set to\n * @returns {Element} iframe DOM element \n */\nexport function getEmptyIframe(height, width) {\n    let frame = document.createElement('iframe');\n    frame.setAttribute('frameborder', 0);\n    frame.setAttribute('scrolling', 'no');\n    frame.setAttribute('marginheight', 0);\n    frame.setAttribute('marginwidth', 0);\n    frame.setAttribute('TOPMARGIN', 0);\n    frame.setAttribute('LEFTMARGIN', 0);\n    frame.setAttribute('allowtransparency', 'true');\n    frame.setAttribute('width', width);\n    frame.setAttribute('height', height);\n    return frame;\n  }\n\n  /**\n * Insert element to passed target\n * @param {object} elm\n * @param {object} doc\n * @param {string} target\n */\nexport function insertElement(elm, doc, target) {\n    doc = doc || document;\n    let elToAppend;\n    if (target) {\n      elToAppend = doc.getElementsByTagName(target);\n    } else {\n      elToAppend = doc.getElementsByTagName('head');\n    }\n    try {\n      elToAppend = elToAppend.length ? elToAppend : doc.getElementsByTagName('body');\n      if (elToAppend.length) {\n        elToAppend = elToAppend[0];\n        elToAppend.insertBefore(elm, elToAppend.firstChild);\n      }\n    } catch (e) {}\n  }\n\n\n// WEBPACK FOOTER //\n// ./src/domHelper.js","/**\n * @file postscribe\n * @description Asynchronously write javascript, even with document.write.\n * @version v2.0.8\n * @see {@link https://krux.github.io/postscribe}\n * @license MIT\n * @author Derek Brans\n * @copyright 2016 Krux Digital, Inc\n */\n(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"postscribe\"] = factory();\n\telse\n\t\troot[\"postscribe\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _postscribe = __webpack_require__(1);\n\t\n\tvar _postscribe2 = _interopRequireDefault(_postscribe);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tmodule.exports = _postscribe2['default'];\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\texports.__esModule = true;\n\t\n\tvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\t\n\texports['default'] = postscribe;\n\t\n\tvar _writeStream = __webpack_require__(2);\n\t\n\tvar _writeStream2 = _interopRequireDefault(_writeStream);\n\t\n\tvar _utils = __webpack_require__(4);\n\t\n\tvar utils = _interopRequireWildcard(_utils);\n\t\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\t/**\n\t * A function that intentionally does nothing.\n\t */\n\tfunction doNothing() {}\n\t\n\t/**\n\t * Available options and defaults.\n\t *\n\t * @type {Object}\n\t */\n\tvar OPTIONS = {\n\t  /**\n\t   * Called when an async script has loaded.\n\t   */\n\t  afterAsync: doNothing,\n\t\n\t  /**\n\t   * Called immediately before removing from the write queue.\n\t   */\n\t  afterDequeue: doNothing,\n\t\n\t  /**\n\t   * Called sync after a stream's first thread release.\n\t   */\n\t  afterStreamStart: doNothing,\n\t\n\t  /**\n\t   * Called after writing buffered document.write calls.\n\t   */\n\t  afterWrite: doNothing,\n\t\n\t  /**\n\t   * Allows disabling the autoFix feature of prescribe\n\t   */\n\t  autoFix: true,\n\t\n\t  /**\n\t   * Called immediately before adding to the write queue.\n\t   */\n\t  beforeEnqueue: doNothing,\n\t\n\t  /**\n\t   * Called before writing a token.\n\t   *\n\t   * @param {Object} tok The token\n\t   */\n\t  beforeWriteToken: function beforeWriteToken(tok) {\n\t    return tok;\n\t  },\n\t\n\t  /**\n\t   * Called before writing buffered document.write calls.\n\t   *\n\t   * @param {String} str The string\n\t   */\n\t  beforeWrite: function beforeWrite(str) {\n\t    return str;\n\t  },\n\t\n\t  /**\n\t   * Called when evaluation is finished.\n\t   */\n\t  done: doNothing,\n\t\n\t  /**\n\t   * Called when a write results in an error.\n\t   *\n\t   * @param {Error} e The error\n\t   */\n\t  error: function error(e) {\n\t    throw new Error(e.msg);\n\t  },\n\t\n\t\n\t  /**\n\t   * Whether to let scripts w/ async attribute set fall out of the queue.\n\t   */\n\t  releaseAsync: false\n\t};\n\t\n\tvar nextId = 0;\n\tvar queue = [];\n\tvar active = null;\n\t\n\tfunction nextStream() {\n\t  var args = queue.shift();\n\t  if (args) {\n\t    var options = utils.last(args);\n\t\n\t    options.afterDequeue();\n\t    args.stream = runStream.apply(undefined, args);\n\t    options.afterStreamStart();\n\t  }\n\t}\n\t\n\tfunction runStream(el, html, options) {\n\t  active = new _writeStream2['default'](el, options);\n\t\n\t  // Identify this stream.\n\t  active.id = nextId++;\n\t  active.name = options.name || active.id;\n\t  postscribe.streams[active.name] = active;\n\t\n\t  // Override document.write.\n\t  var doc = el.ownerDocument;\n\t\n\t  var stash = {\n\t    close: doc.close,\n\t    open: doc.open,\n\t    write: doc.write,\n\t    writeln: doc.writeln\n\t  };\n\t\n\t  function _write(str) {\n\t    str = options.beforeWrite(str);\n\t    active.write(str);\n\t    options.afterWrite(str);\n\t  }\n\t\n\t  _extends(doc, {\n\t    close: doNothing,\n\t    open: doNothing,\n\t    write: function write() {\n\t      for (var _len = arguments.length, str = Array(_len), _key = 0; _key < _len; _key++) {\n\t        str[_key] = arguments[_key];\n\t      }\n\t\n\t      return _write(str.join(''));\n\t    },\n\t    writeln: function writeln() {\n\t      for (var _len2 = arguments.length, str = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n\t        str[_key2] = arguments[_key2];\n\t      }\n\t\n\t      return _write(str.join('') + '\\n');\n\t    }\n\t  });\n\t\n\t  // Override window.onerror\n\t  var oldOnError = active.win.onerror || doNothing;\n\t\n\t  // This works together with the try/catch around WriteStream::insertScript\n\t  // In modern browsers, exceptions in tag scripts go directly to top level\n\t  active.win.onerror = function (msg, url, line) {\n\t    options.error({ msg: msg + ' - ' + url + ': ' + line });\n\t    oldOnError.apply(active.win, [msg, url, line]);\n\t  };\n\t\n\t  // Write to the stream\n\t  active.write(html, function () {\n\t    // restore document.write\n\t    _extends(doc, stash);\n\t\n\t    // restore window.onerror\n\t    active.win.onerror = oldOnError;\n\t\n\t    options.done();\n\t    active = null;\n\t    nextStream();\n\t  });\n\t\n\t  return active;\n\t}\n\t\n\tfunction postscribe(el, html, options) {\n\t  if (utils.isFunction(options)) {\n\t    options = { done: options };\n\t  } else if (options === 'clear') {\n\t    queue = [];\n\t    active = null;\n\t    nextId = 0;\n\t    return;\n\t  }\n\t\n\t  options = utils.defaults(options, OPTIONS);\n\t\n\t  // id selector\n\t  if (/^#/.test(el)) {\n\t    el = window.document.getElementById(el.substr(1));\n\t  } else {\n\t    el = el.jquery ? el[0] : el;\n\t  }\n\t\n\t  var args = [el, html, options];\n\t\n\t  el.postscribe = {\n\t    cancel: function cancel() {\n\t      if (args.stream) {\n\t        args.stream.abort();\n\t      } else {\n\t        args[1] = doNothing;\n\t      }\n\t    }\n\t  };\n\t\n\t  options.beforeEnqueue(args);\n\t  queue.push(args);\n\t\n\t  if (!active) {\n\t    nextStream();\n\t  }\n\t\n\t  return el.postscribe;\n\t}\n\t\n\t_extends(postscribe, {\n\t  // Streams by name.\n\t  streams: {},\n\t  // Queue of streams.\n\t  queue: queue,\n\t  // Expose internal classes.\n\t  WriteStream: _writeStream2['default']\n\t});\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\texports.__esModule = true;\n\t\n\tvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\t\n\tvar _prescribe = __webpack_require__(3);\n\t\n\tvar _prescribe2 = _interopRequireDefault(_prescribe);\n\t\n\tvar _utils = __webpack_require__(4);\n\t\n\tvar utils = _interopRequireWildcard(_utils);\n\t\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/**\n\t * Turn on to debug how each chunk affected the DOM.\n\t * @type {boolean}\n\t */\n\tvar DEBUG_CHUNK = false;\n\t\n\t/**\n\t * Prefix for data attributes on DOM elements.\n\t * @type {string}\n\t */\n\tvar BASEATTR = 'data-ps-';\n\t\n\t/**\n\t * ID for the style proxy\n\t * @type {string}\n\t */\n\tvar PROXY_STYLE = 'ps-style';\n\t\n\t/**\n\t * ID for the script proxy\n\t * @type {string}\n\t */\n\tvar PROXY_SCRIPT = 'ps-script';\n\t\n\t/**\n\t * Get data attributes\n\t *\n\t * @param {Object} el The DOM element.\n\t * @param {String} name The attribute name.\n\t * @returns {String}\n\t */\n\tfunction getData(el, name) {\n\t  var attr = BASEATTR + name;\n\t\n\t  var val = el.getAttribute(attr);\n\t\n\t  // IE 8 returns a number if it's a number\n\t  return !utils.existy(val) ? val : String(val);\n\t}\n\t\n\t/**\n\t * Set data attributes\n\t *\n\t * @param {Object} el The DOM element.\n\t * @param {String} name The attribute name.\n\t * @param {null|*} value The attribute value.\n\t */\n\tfunction setData(el, name) {\n\t  var value = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\t\n\t  var attr = BASEATTR + name;\n\t\n\t  if (utils.existy(value) && value !== '') {\n\t    el.setAttribute(attr, value);\n\t  } else {\n\t    el.removeAttribute(attr);\n\t  }\n\t}\n\t\n\t/**\n\t * Stream static html to an element, where \"static html\" denotes \"html\n\t * without scripts\".\n\t *\n\t * This class maintains a *history of writes devoid of any attributes* or\n\t * \"proxy history\".\n\t *\n\t * Injecting the proxy history into a temporary div has no side-effects,\n\t * other than to create proxy elements for previously written elements.\n\t *\n\t * Given the `staticHtml` of a new write, a `tempDiv`'s innerHTML is set to\n\t * `proxy_history + staticHtml`.\n\t * The *structure* of `tempDiv`'s contents, (i.e., the placement of new nodes\n\t * beside or inside of proxy elements), reflects the DOM structure that would\n\t * have resulted if all writes had been squashed into a single write.\n\t *\n\t * For each descendent `node` of `tempDiv` whose parentNode is a *proxy*,\n\t * `node` is appended to the corresponding *real* element within the DOM.\n\t *\n\t * Proxy elements are mapped to *actual* elements in the DOM by injecting a\n\t * `data-id` attribute into each start tag in `staticHtml`.\n\t *\n\t */\n\t\n\tvar WriteStream = function () {\n\t  /**\n\t   * Constructor.\n\t   *\n\t   * @param {Object} root The root element\n\t   * @param {?Object} options The options\n\t   */\n\t  function WriteStream(root) {\n\t    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\t\n\t    _classCallCheck(this, WriteStream);\n\t\n\t    this.root = root;\n\t    this.options = options;\n\t    this.doc = root.ownerDocument;\n\t    this.win = this.doc.defaultView || this.doc.parentWindow;\n\t    this.parser = new _prescribe2['default']('', { autoFix: options.autoFix });\n\t\n\t    // Actual elements by id.\n\t    this.actuals = [root];\n\t\n\t    // Embodies the \"structure\" of what's been written so far,\n\t    // devoid of attributes.\n\t    this.proxyHistory = '';\n\t\n\t    // Create a proxy of the root element.\n\t    this.proxyRoot = this.doc.createElement(root.nodeName);\n\t\n\t    this.scriptStack = [];\n\t    this.writeQueue = [];\n\t\n\t    setData(this.proxyRoot, 'proxyof', 0);\n\t  }\n\t\n\t  /**\n\t   * Writes the given strings.\n\t   *\n\t   * @param {...String} str The strings to write\n\t   */\n\t\n\t\n\t  WriteStream.prototype.write = function write() {\n\t    var _writeQueue;\n\t\n\t    (_writeQueue = this.writeQueue).push.apply(_writeQueue, arguments);\n\t\n\t    // Process writes\n\t    // When new script gets pushed or pending this will stop\n\t    // because new writeQueue gets pushed\n\t    while (!this.deferredRemote && this.writeQueue.length) {\n\t      var arg = this.writeQueue.shift();\n\t\n\t      if (utils.isFunction(arg)) {\n\t        this._callFunction(arg);\n\t      } else {\n\t        this._writeImpl(arg);\n\t      }\n\t    }\n\t  };\n\t\n\t  /**\n\t   * Calls the given function.\n\t   *\n\t   * @param {Function} fn The function to call\n\t   * @private\n\t   */\n\t\n\t\n\t  WriteStream.prototype._callFunction = function _callFunction(fn) {\n\t    var tok = { type: 'function', value: fn.name || fn.toString() };\n\t    this._onScriptStart(tok);\n\t    fn.call(this.win, this.doc);\n\t    this._onScriptDone(tok);\n\t  };\n\t\n\t  /**\n\t   * The write implementation\n\t   *\n\t   * @param {String} html The HTML to write.\n\t   * @private\n\t   */\n\t\n\t\n\t  WriteStream.prototype._writeImpl = function _writeImpl(html) {\n\t    this.parser.append(html);\n\t\n\t    var tok = void 0;\n\t    var script = void 0;\n\t    var style = void 0;\n\t    var tokens = [];\n\t\n\t    // stop if we see a script token\n\t    while ((tok = this.parser.readToken()) && !(script = utils.isScript(tok)) && !(style = utils.isStyle(tok))) {\n\t      tok = this.options.beforeWriteToken(tok);\n\t\n\t      if (tok) {\n\t        tokens.push(tok);\n\t      }\n\t    }\n\t\n\t    if (tokens.length > 0) {\n\t      this._writeStaticTokens(tokens);\n\t    }\n\t\n\t    if (script) {\n\t      this._handleScriptToken(tok);\n\t    }\n\t\n\t    if (style) {\n\t      this._handleStyleToken(tok);\n\t    }\n\t  };\n\t\n\t  /**\n\t   * Write contiguous non-script tokens (a chunk)\n\t   *\n\t   * @param {Array<Object>} tokens The tokens\n\t   * @returns {{tokens, raw, actual, proxy}|null}\n\t   * @private\n\t   */\n\t\n\t\n\t  WriteStream.prototype._writeStaticTokens = function _writeStaticTokens(tokens) {\n\t    var chunk = this._buildChunk(tokens);\n\t\n\t    if (!chunk.actual) {\n\t      // e.g., no tokens, or a noscript that got ignored\n\t      return null;\n\t    }\n\t\n\t    chunk.html = this.proxyHistory + chunk.actual;\n\t    this.proxyHistory += chunk.proxy;\n\t    this.proxyRoot.innerHTML = chunk.html;\n\t\n\t    if (DEBUG_CHUNK) {\n\t      chunk.proxyInnerHTML = this.proxyRoot.innerHTML;\n\t    }\n\t\n\t    this._walkChunk();\n\t\n\t    if (DEBUG_CHUNK) {\n\t      chunk.actualInnerHTML = this.root.innerHTML;\n\t    }\n\t\n\t    return chunk;\n\t  };\n\t\n\t  /**\n\t   * Build a chunk.\n\t   *\n\t   * @param {Array<Object>} tokens The tokens to use.\n\t   * @returns {{tokens: *, raw: string, actual: string, proxy: string}}\n\t   * @private\n\t   */\n\t\n\t\n\t  WriteStream.prototype._buildChunk = function _buildChunk(tokens) {\n\t    var nextId = this.actuals.length;\n\t\n\t    // The raw html of this chunk.\n\t    var raw = [];\n\t\n\t    // The html to create the nodes in the tokens (with id's injected).\n\t    var actual = [];\n\t\n\t    // Html that can later be used to proxy the nodes in the tokens.\n\t    var proxy = [];\n\t\n\t    var len = tokens.length;\n\t    for (var i = 0; i < len; i++) {\n\t      var tok = tokens[i];\n\t      var tokenRaw = tok.toString();\n\t\n\t      raw.push(tokenRaw);\n\t\n\t      if (tok.attrs) {\n\t        // tok.attrs <==> startTag or atomicTag or cursor\n\t        // Ignore noscript tags. They are atomic, so we don't have to worry about children.\n\t        if (!/^noscript$/i.test(tok.tagName)) {\n\t          var id = nextId++;\n\t\n\t          // Actual: inject id attribute: replace '>' at end of start tag with id attribute + '>'\n\t          actual.push(tokenRaw.replace(/(\\/?>)/, ' ' + BASEATTR + 'id=' + id + ' $1'));\n\t\n\t          // Don't proxy scripts: they have no bearing on DOM structure.\n\t          if (tok.attrs.id !== PROXY_SCRIPT && tok.attrs.id !== PROXY_STYLE) {\n\t            // Proxy: strip all attributes and inject proxyof attribute\n\t            proxy.push(\n\t            // ignore atomic tags (e.g., style): they have no \"structural\" effect\n\t            tok.type === 'atomicTag' ? '' : '<' + tok.tagName + ' ' + BASEATTR + 'proxyof=' + id + (tok.unary ? ' />' : '>'));\n\t          }\n\t        }\n\t      } else {\n\t        // Visit any other type of token\n\t        // Actual: append.\n\t        actual.push(tokenRaw);\n\t\n\t        // Proxy: append endTags. Ignore everything else.\n\t        proxy.push(tok.type === 'endTag' ? tokenRaw : '');\n\t      }\n\t    }\n\t\n\t    return {\n\t      tokens: tokens,\n\t      raw: raw.join(''),\n\t      actual: actual.join(''),\n\t      proxy: proxy.join('')\n\t    };\n\t  };\n\t\n\t  /**\n\t   * Walk the chunks.\n\t   *\n\t   * @private\n\t   */\n\t\n\t\n\t  WriteStream.prototype._walkChunk = function _walkChunk() {\n\t    var node = void 0;\n\t    var stack = [this.proxyRoot];\n\t\n\t    // use shift/unshift so that children are walked in document order\n\t    while (utils.existy(node = stack.shift())) {\n\t      var isElement = node.nodeType === 1;\n\t      var isProxy = isElement && getData(node, 'proxyof');\n\t\n\t      // Ignore proxies\n\t      if (!isProxy) {\n\t        if (isElement) {\n\t          // New actual element: register it and remove the the id attr.\n\t          this.actuals[getData(node, 'id')] = node;\n\t          setData(node, 'id');\n\t        }\n\t\n\t        // Is node's parent a proxy?\n\t        var parentIsProxyOf = node.parentNode && getData(node.parentNode, 'proxyof');\n\t        if (parentIsProxyOf) {\n\t          // Move node under actual parent.\n\t          this.actuals[parentIsProxyOf].appendChild(node);\n\t        }\n\t      }\n\t\n\t      // prepend childNodes to stack\n\t      stack.unshift.apply(stack, utils.toArray(node.childNodes));\n\t    }\n\t  };\n\t\n\t  /**\n\t   * Handles Script tokens\n\t   *\n\t   * @param {Object} tok The token\n\t   */\n\t\n\t\n\t  WriteStream.prototype._handleScriptToken = function _handleScriptToken(tok) {\n\t    var _this = this;\n\t\n\t    var remainder = this.parser.clear();\n\t\n\t    if (remainder) {\n\t      // Write remainder immediately behind this script.\n\t      this.writeQueue.unshift(remainder);\n\t    }\n\t\n\t    tok.src = tok.attrs.src || tok.attrs.SRC;\n\t\n\t    tok = this.options.beforeWriteToken(tok);\n\t    if (!tok) {\n\t      // User has removed this token\n\t      return;\n\t    }\n\t\n\t    if (tok.src && this.scriptStack.length) {\n\t      // Defer this script until scriptStack is empty.\n\t      // Assumption 1: This script will not start executing until\n\t      // scriptStack is empty.\n\t      this.deferredRemote = tok;\n\t    } else {\n\t      this._onScriptStart(tok);\n\t    }\n\t\n\t    // Put the script node in the DOM.\n\t    this._writeScriptToken(tok, function () {\n\t      _this._onScriptDone(tok);\n\t    });\n\t  };\n\t\n\t  /**\n\t   * Handles style tokens\n\t   *\n\t   * @param {Object} tok The token\n\t   */\n\t\n\t\n\t  WriteStream.prototype._handleStyleToken = function _handleStyleToken(tok) {\n\t    var remainder = this.parser.clear();\n\t\n\t    if (remainder) {\n\t      // Write remainder immediately behind this style.\n\t      this.writeQueue.unshift(remainder);\n\t    }\n\t\n\t    tok.type = tok.attrs.type || tok.attrs.TYPE || 'text/css';\n\t\n\t    tok = this.options.beforeWriteToken(tok);\n\t\n\t    if (tok) {\n\t      // Put the style node in the DOM.\n\t      this._writeStyleToken(tok);\n\t    }\n\t\n\t    if (remainder) {\n\t      this.write();\n\t    }\n\t  };\n\t\n\t  /**\n\t   * Build a style and insert it into the DOM.\n\t   *\n\t   * @param {Object} tok The token\n\t   */\n\t\n\t\n\t  WriteStream.prototype._writeStyleToken = function _writeStyleToken(tok) {\n\t    var el = this._buildStyle(tok);\n\t\n\t    this._insertCursor(el, PROXY_STYLE);\n\t\n\t    // Set content\n\t    if (tok.content) {\n\t      if (el.styleSheet && !el.sheet) {\n\t        el.styleSheet.cssText = tok.content;\n\t      } else {\n\t        el.appendChild(this.doc.createTextNode(tok.content));\n\t      }\n\t    }\n\t  };\n\t\n\t  /**\n\t   * Build a style element from an atomic style token.\n\t   *\n\t   * @param {Object} tok The token\n\t   * @returns {Element}\n\t   */\n\t\n\t\n\t  WriteStream.prototype._buildStyle = function _buildStyle(tok) {\n\t    var el = this.doc.createElement(tok.tagName);\n\t\n\t    el.setAttribute('type', tok.type);\n\t\n\t    // Set attributes\n\t    utils.eachKey(tok.attrs, function (name, value) {\n\t      el.setAttribute(name, value);\n\t    });\n\t\n\t    return el;\n\t  };\n\t\n\t  /**\n\t   * Append a span to the stream. That span will act as a cursor\n\t   * (i.e. insertion point) for the element.\n\t   *\n\t   * @param {Object} el The element\n\t   * @param {string} which The type of proxy element\n\t   */\n\t\n\t\n\t  WriteStream.prototype._insertCursor = function _insertCursor(el, which) {\n\t    this._writeImpl('<span id=\"' + which + '\"/>');\n\t\n\t    var cursor = this.doc.getElementById(which);\n\t\n\t    if (cursor) {\n\t      cursor.parentNode.replaceChild(el, cursor);\n\t    }\n\t  };\n\t\n\t  /**\n\t   * Called when a script is started.\n\t   *\n\t   * @param {Object} tok The token\n\t   * @private\n\t   */\n\t\n\t\n\t  WriteStream.prototype._onScriptStart = function _onScriptStart(tok) {\n\t    tok.outerWrites = this.writeQueue;\n\t    this.writeQueue = [];\n\t    this.scriptStack.unshift(tok);\n\t  };\n\t\n\t  /**\n\t   * Called when a script is done.\n\t   *\n\t   * @param {Object} tok The token\n\t   * @private\n\t   */\n\t\n\t\n\t  WriteStream.prototype._onScriptDone = function _onScriptDone(tok) {\n\t    // Pop script and check nesting.\n\t    if (tok !== this.scriptStack[0]) {\n\t      this.options.error({ msg: 'Bad script nesting or script finished twice' });\n\t      return;\n\t    }\n\t\n\t    this.scriptStack.shift();\n\t\n\t    // Append outer writes to queue and process them.\n\t    this.write.apply(this, tok.outerWrites);\n\t\n\t    // Check for pending remote\n\t\n\t    // Assumption 2: if remote_script1 writes remote_script2 then\n\t    // the we notice remote_script1 finishes before remote_script2 starts.\n\t    // I think this is equivalent to assumption 1\n\t    if (!this.scriptStack.length && this.deferredRemote) {\n\t      this._onScriptStart(this.deferredRemote);\n\t      this.deferredRemote = null;\n\t    }\n\t  };\n\t\n\t  /**\n\t   * Build a script and insert it into the DOM.\n\t   * Done is called once script has executed.\n\t   *\n\t   * @param {Object} tok The token\n\t   * @param {Function} done The callback when complete\n\t   */\n\t\n\t\n\t  WriteStream.prototype._writeScriptToken = function _writeScriptToken(tok, done) {\n\t    var el = this._buildScript(tok);\n\t    var asyncRelease = this._shouldRelease(el);\n\t    var afterAsync = this.options.afterAsync;\n\t\n\t    if (tok.src) {\n\t      // Fix for attribute \"SRC\" (capitalized). IE does not recognize it.\n\t      el.src = tok.src;\n\t      this._scriptLoadHandler(el, !asyncRelease ? function () {\n\t        done();\n\t        afterAsync();\n\t      } : afterAsync);\n\t    }\n\t\n\t    try {\n\t      this._insertCursor(el, PROXY_SCRIPT);\n\t      if (!el.src || asyncRelease) {\n\t        done();\n\t      }\n\t    } catch (e) {\n\t      this.options.error(e);\n\t      done();\n\t    }\n\t  };\n\t\n\t  /**\n\t   * Build a script element from an atomic script token.\n\t   *\n\t   * @param {Object} tok The token\n\t   * @returns {Element}\n\t   */\n\t\n\t\n\t  WriteStream.prototype._buildScript = function _buildScript(tok) {\n\t    var el = this.doc.createElement(tok.tagName);\n\t\n\t    // Set attributes\n\t    utils.eachKey(tok.attrs, function (name, value) {\n\t      el.setAttribute(name, value);\n\t    });\n\t\n\t    // Set content\n\t    if (tok.content) {\n\t      el.text = tok.content;\n\t    }\n\t\n\t    return el;\n\t  };\n\t\n\t  /**\n\t   * Setup the script load handler on an element.\n\t   *\n\t   * @param {Object} el The element\n\t   * @param {Function} done The callback\n\t   * @private\n\t   */\n\t\n\t\n\t  WriteStream.prototype._scriptLoadHandler = function _scriptLoadHandler(el, done) {\n\t    function cleanup() {\n\t      el = el.onload = el.onreadystatechange = el.onerror = null;\n\t    }\n\t\n\t    var error = this.options.error;\n\t\n\t    function success() {\n\t      cleanup();\n\t      if (done != null) {\n\t        done();\n\t      }\n\t      done = null;\n\t    }\n\t\n\t    function failure(err) {\n\t      cleanup();\n\t      error(err);\n\t      if (done != null) {\n\t        done();\n\t      }\n\t      done = null;\n\t    }\n\t\n\t    function reattachEventListener(el, evt) {\n\t      var handler = el['on' + evt];\n\t      if (handler != null) {\n\t        el['_on' + evt] = handler;\n\t      }\n\t    }\n\t\n\t    reattachEventListener(el, 'load');\n\t    reattachEventListener(el, 'error');\n\t\n\t    _extends(el, {\n\t      onload: function onload() {\n\t        if (el._onload) {\n\t          try {\n\t            el._onload.apply(this, Array.prototype.slice.call(arguments, 0));\n\t          } catch (err) {\n\t            failure({ msg: 'onload handler failed ' + err + ' @ ' + el.src });\n\t          }\n\t        }\n\t        success();\n\t      },\n\t      onerror: function onerror() {\n\t        if (el._onerror) {\n\t          try {\n\t            el._onerror.apply(this, Array.prototype.slice.call(arguments, 0));\n\t          } catch (err) {\n\t            failure({ msg: 'onerror handler failed ' + err + ' @ ' + el.src });\n\t            return;\n\t          }\n\t        }\n\t        failure({ msg: 'remote script failed ' + el.src });\n\t      },\n\t      onreadystatechange: function onreadystatechange() {\n\t        if (/^(loaded|complete)$/.test(el.readyState)) {\n\t          success();\n\t        }\n\t      }\n\t    });\n\t  };\n\t\n\t  /**\n\t   * Determines whether to release.\n\t   *\n\t   * @param {Object} el The element\n\t   * @returns {boolean}\n\t   * @private\n\t   */\n\t\n\t\n\t  WriteStream.prototype._shouldRelease = function _shouldRelease(el) {\n\t    var isScript = /^script$/i.test(el.nodeName);\n\t    return !isScript || !!(this.options.releaseAsync && el.src && el.hasAttribute('async'));\n\t  };\n\t\n\t  return WriteStream;\n\t}();\n\t\n\texports['default'] = WriteStream;\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/**\n\t * @file prescribe\n\t * @description Tiny, forgiving HTML parser\n\t * @version vundefined\n\t * @see {@link https://github.com/krux/prescribe/}\n\t * @license MIT\n\t * @author Derek Brans\n\t * @copyright 2016 Krux Digital, Inc\n\t */\n\t(function webpackUniversalModuleDefinition(root, factory) {\n\t\tif(true)\n\t\t\tmodule.exports = factory();\n\t\telse if(typeof define === 'function' && define.amd)\n\t\t\tdefine([], factory);\n\t\telse if(typeof exports === 'object')\n\t\t\texports[\"Prescribe\"] = factory();\n\t\telse\n\t\t\troot[\"Prescribe\"] = factory();\n\t})(this, function() {\n\treturn /******/ (function(modules) { // webpackBootstrap\n\t/******/ \t// The module cache\n\t/******/ \tvar installedModules = {};\n\t\n\t/******/ \t// The require function\n\t/******/ \tfunction __webpack_require__(moduleId) {\n\t\n\t/******/ \t\t// Check if module is in cache\n\t/******/ \t\tif(installedModules[moduleId])\n\t/******/ \t\t\treturn installedModules[moduleId].exports;\n\t\n\t/******/ \t\t// Create a new module (and put it into the cache)\n\t/******/ \t\tvar module = installedModules[moduleId] = {\n\t/******/ \t\t\texports: {},\n\t/******/ \t\t\tid: moduleId,\n\t/******/ \t\t\tloaded: false\n\t/******/ \t\t};\n\t\n\t/******/ \t\t// Execute the module function\n\t/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\t\n\t/******/ \t\t// Flag the module as loaded\n\t/******/ \t\tmodule.loaded = true;\n\t\n\t/******/ \t\t// Return the exports of the module\n\t/******/ \t\treturn module.exports;\n\t/******/ \t}\n\t\n\t\n\t/******/ \t// expose the modules object (__webpack_modules__)\n\t/******/ \t__webpack_require__.m = modules;\n\t\n\t/******/ \t// expose the module cache\n\t/******/ \t__webpack_require__.c = installedModules;\n\t\n\t/******/ \t// __webpack_public_path__\n\t/******/ \t__webpack_require__.p = \"\";\n\t\n\t/******/ \t// Load entry module and return exports\n\t/******/ \treturn __webpack_require__(0);\n\t/******/ })\n\t/************************************************************************/\n\t/******/ ([\n\t/* 0 */\n\t/***/ function(module, exports, __webpack_require__) {\n\t\n\t\t'use strict';\n\t\n\t\tvar _HtmlParser = __webpack_require__(1);\n\t\n\t\tvar _HtmlParser2 = _interopRequireDefault(_HtmlParser);\n\t\n\t\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\t\tmodule.exports = _HtmlParser2['default'];\n\t\n\t/***/ },\n\t/* 1 */\n\t/***/ function(module, exports, __webpack_require__) {\n\t\n\t\t'use strict';\n\t\n\t\texports.__esModule = true;\n\t\n\t\tvar _supports = __webpack_require__(2);\n\t\n\t\tvar supports = _interopRequireWildcard(_supports);\n\t\n\t\tvar _streamReaders = __webpack_require__(3);\n\t\n\t\tvar streamReaders = _interopRequireWildcard(_streamReaders);\n\t\n\t\tvar _fixedReadTokenFactory = __webpack_require__(6);\n\t\n\t\tvar _fixedReadTokenFactory2 = _interopRequireDefault(_fixedReadTokenFactory);\n\t\n\t\tvar _utils = __webpack_require__(5);\n\t\n\t\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\t\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }\n\t\n\t\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t\t/**\n\t\t * Detection regular expressions.\n\t\t *\n\t\t * Order of detection matters: detection of one can only\n\t\t * succeed if detection of previous didn't\n\t\n\t\t * @type {Object}\n\t\t */\n\t\tvar detect = {\n\t\t  comment: /^<!--/,\n\t\t  endTag: /^<\\//,\n\t\t  atomicTag: /^<\\s*(script|style|noscript|iframe|textarea)[\\s\\/>]/i,\n\t\t  startTag: /^</,\n\t\t  chars: /^[^<]/\n\t\t};\n\t\n\t\t/**\n\t\t * HtmlParser provides the capability to parse HTML and return tokens\n\t\t * representing the tags and content.\n\t\t */\n\t\n\t\tvar HtmlParser = function () {\n\t\t  /**\n\t\t   * Constructor.\n\t\t   *\n\t\t   * @param {string} stream The initial parse stream contents.\n\t\t   * @param {Object} options The options\n\t\t   * @param {boolean} options.autoFix Set to true to automatically fix errors\n\t\t   */\n\t\t  function HtmlParser() {\n\t\t    var _this = this;\n\t\n\t\t    var stream = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n\t\t    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\t\n\t\t    _classCallCheck(this, HtmlParser);\n\t\n\t\t    this.stream = stream;\n\t\n\t\t    var fix = false;\n\t\t    var fixedTokenOptions = {};\n\t\n\t\t    for (var key in supports) {\n\t\t      if (supports.hasOwnProperty(key)) {\n\t\t        if (options.autoFix) {\n\t\t          fixedTokenOptions[key + 'Fix'] = true; // !supports[key];\n\t\t        }\n\t\t        fix = fix || fixedTokenOptions[key + 'Fix'];\n\t\t      }\n\t\t    }\n\t\n\t\t    if (fix) {\n\t\t      this._readToken = (0, _fixedReadTokenFactory2['default'])(this, fixedTokenOptions, function () {\n\t\t        return _this._readTokenImpl();\n\t\t      });\n\t\t      this._peekToken = (0, _fixedReadTokenFactory2['default'])(this, fixedTokenOptions, function () {\n\t\t        return _this._peekTokenImpl();\n\t\t      });\n\t\t    } else {\n\t\t      this._readToken = this._readTokenImpl;\n\t\t      this._peekToken = this._peekTokenImpl;\n\t\t    }\n\t\t  }\n\t\n\t\t  /**\n\t\t   * Appends the given string to the parse stream.\n\t\t   *\n\t\t   * @param {string} str The string to append\n\t\t   */\n\t\n\t\n\t\t  HtmlParser.prototype.append = function append(str) {\n\t\t    this.stream += str;\n\t\t  };\n\t\n\t\t  /**\n\t\t   * Prepends the given string to the parse stream.\n\t\t   *\n\t\t   * @param {string} str The string to prepend\n\t\t   */\n\t\n\t\n\t\t  HtmlParser.prototype.prepend = function prepend(str) {\n\t\t    this.stream = str + this.stream;\n\t\t  };\n\t\n\t\t  /**\n\t\t   * The implementation of the token reading.\n\t\t   *\n\t\t   * @private\n\t\t   * @returns {?Token}\n\t\t   */\n\t\n\t\n\t\t  HtmlParser.prototype._readTokenImpl = function _readTokenImpl() {\n\t\t    var token = this._peekTokenImpl();\n\t\t    if (token) {\n\t\t      this.stream = this.stream.slice(token.length);\n\t\t      return token;\n\t\t    }\n\t\t  };\n\t\n\t\t  /**\n\t\t   * The implementation of token peeking.\n\t\t   *\n\t\t   * @returns {?Token}\n\t\t   */\n\t\n\t\n\t\t  HtmlParser.prototype._peekTokenImpl = function _peekTokenImpl() {\n\t\t    for (var type in detect) {\n\t\t      if (detect.hasOwnProperty(type)) {\n\t\t        if (detect[type].test(this.stream)) {\n\t\t          var token = streamReaders[type](this.stream);\n\t\n\t\t          if (token) {\n\t\t            if (token.type === 'startTag' && /script|style/i.test(token.tagName)) {\n\t\t              return null;\n\t\t            } else {\n\t\t              token.text = this.stream.substr(0, token.length);\n\t\t              return token;\n\t\t            }\n\t\t          }\n\t\t        }\n\t\t      }\n\t\t    }\n\t\t  };\n\t\n\t\t  /**\n\t\t   * The public token peeking interface.  Delegates to the basic token peeking\n\t\t   * or a version that performs fixups depending on the `autoFix` setting in\n\t\t   * options.\n\t\t   *\n\t\t   * @returns {object}\n\t\t   */\n\t\n\t\n\t\t  HtmlParser.prototype.peekToken = function peekToken() {\n\t\t    return this._peekToken();\n\t\t  };\n\t\n\t\t  /**\n\t\t   * The public token reading interface.  Delegates to the basic token reading\n\t\t   * or a version that performs fixups depending on the `autoFix` setting in\n\t\t   * options.\n\t\t   *\n\t\t   * @returns {object}\n\t\t   */\n\t\n\t\n\t\t  HtmlParser.prototype.readToken = function readToken() {\n\t\t    return this._readToken();\n\t\t  };\n\t\n\t\t  /**\n\t\t   * Read tokens and hand to the given handlers.\n\t\t   *\n\t\t   * @param {Object} handlers The handlers to use for the different tokens.\n\t\t   */\n\t\n\t\n\t\t  HtmlParser.prototype.readTokens = function readTokens(handlers) {\n\t\t    var tok = void 0;\n\t\t    while (tok = this.readToken()) {\n\t\t      // continue until we get an explicit \"false\" return\n\t\t      if (handlers[tok.type] && handlers[tok.type](tok) === false) {\n\t\t        return;\n\t\t      }\n\t\t    }\n\t\t  };\n\t\n\t\t  /**\n\t\t   * Clears the parse stream.\n\t\t   *\n\t\t   * @returns {string} The contents of the parse stream before clearing.\n\t\t   */\n\t\n\t\n\t\t  HtmlParser.prototype.clear = function clear() {\n\t\t    var rest = this.stream;\n\t\t    this.stream = '';\n\t\t    return rest;\n\t\t  };\n\t\n\t\t  /**\n\t\t   * Returns the rest of the parse stream.\n\t\t   *\n\t\t   * @returns {string} The contents of the parse stream.\n\t\t   */\n\t\n\t\n\t\t  HtmlParser.prototype.rest = function rest() {\n\t\t    return this.stream;\n\t\t  };\n\t\n\t\t  return HtmlParser;\n\t\t}();\n\t\n\t\texports['default'] = HtmlParser;\n\t\n\t\n\t\tHtmlParser.tokenToString = function (tok) {\n\t\t  return tok.toString();\n\t\t};\n\t\n\t\tHtmlParser.escapeAttributes = function (attrs) {\n\t\t  var escapedAttrs = {};\n\t\n\t\t  for (var name in attrs) {\n\t\t    if (attrs.hasOwnProperty(name)) {\n\t\t      escapedAttrs[name] = (0, _utils.escapeQuotes)(attrs[name], null);\n\t\t    }\n\t\t  }\n\t\n\t\t  return escapedAttrs;\n\t\t};\n\t\n\t\tHtmlParser.supports = supports;\n\t\n\t\tfor (var key in supports) {\n\t\t  if (supports.hasOwnProperty(key)) {\n\t\t    HtmlParser.browserHasFlaw = HtmlParser.browserHasFlaw || !supports[key] && key;\n\t\t  }\n\t\t}\n\t\n\t/***/ },\n\t/* 2 */\n\t/***/ function(module, exports) {\n\t\n\t\t'use strict';\n\t\n\t\texports.__esModule = true;\n\t\tvar tagSoup = false;\n\t\tvar selfClose = false;\n\t\n\t\tvar work = window.document.createElement('div');\n\t\n\t\ttry {\n\t\t  var html = '<P><I></P></I>';\n\t\t  work.innerHTML = html;\n\t\t  exports.tagSoup = tagSoup = work.innerHTML !== html;\n\t\t} catch (e) {\n\t\t  exports.tagSoup = tagSoup = false;\n\t\t}\n\t\n\t\ttry {\n\t\t  work.innerHTML = '<P><i><P></P></i></P>';\n\t\t  exports.selfClose = selfClose = work.childNodes.length === 2;\n\t\t} catch (e) {\n\t\t  exports.selfClose = selfClose = false;\n\t\t}\n\t\n\t\twork = null;\n\t\n\t\texports.tagSoup = tagSoup;\n\t\texports.selfClose = selfClose;\n\t\n\t/***/ },\n\t/* 3 */\n\t/***/ function(module, exports, __webpack_require__) {\n\t\n\t\t'use strict';\n\t\n\t\texports.__esModule = true;\n\t\n\t\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\t\n\t\texports.comment = comment;\n\t\texports.chars = chars;\n\t\texports.startTag = startTag;\n\t\texports.atomicTag = atomicTag;\n\t\texports.endTag = endTag;\n\t\n\t\tvar _tokens = __webpack_require__(4);\n\t\n\t\t/**\n\t\t * Regular Expressions for parsing tags and attributes\n\t\t *\n\t\t * @type {Object}\n\t\t */\n\t\tvar REGEXES = {\n\t\t  startTag: /^<([\\-A-Za-z0-9_]+)((?:\\s+[\\w\\-]+(?:\\s*=?\\s*(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>\\s]+))?)*)\\s*(\\/?)>/,\n\t\t  endTag: /^<\\/([\\-A-Za-z0-9_]+)[^>]*>/,\n\t\t  attr: /(?:([\\-A-Za-z0-9_]+)\\s*=\\s*(?:(?:\"((?:\\\\.|[^\"])*)\")|(?:'((?:\\\\.|[^'])*)')|([^>\\s]+)))|(?:([\\-A-Za-z0-9_]+)(\\s|$)+)/g,\n\t\t  fillAttr: /^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noresize|noshade|nowrap|readonly|selected)$/i\n\t\t};\n\t\n\t\t/**\n\t\t * Reads a comment token\n\t\t *\n\t\t * @param {string} stream The input stream\n\t\t * @returns {CommentToken}\n\t\t */\n\t\tfunction comment(stream) {\n\t\t  var index = stream.indexOf('-->');\n\t\t  if (index >= 0) {\n\t\t    return new _tokens.CommentToken(stream.substr(4, index - 1), index + 3);\n\t\t  }\n\t\t}\n\t\n\t\t/**\n\t\t * Reads non-tag characters.\n\t\t *\n\t\t * @param {string} stream The input stream\n\t\t * @returns {CharsToken}\n\t\t */\n\t\tfunction chars(stream) {\n\t\t  var index = stream.indexOf('<');\n\t\t  return new _tokens.CharsToken(index >= 0 ? index : stream.length);\n\t\t}\n\t\n\t\t/**\n\t\t * Reads start tag token.\n\t\t *\n\t\t * @param {string} stream The input stream\n\t\t * @returns {StartTagToken}\n\t\t */\n\t\tfunction startTag(stream) {\n\t\t  var endTagIndex = stream.indexOf('>');\n\t\t  if (endTagIndex !== -1) {\n\t\t    var match = stream.match(REGEXES.startTag);\n\t\t    if (match) {\n\t\t      var _ret = function () {\n\t\t        var attrs = {};\n\t\t        var booleanAttrs = {};\n\t\t        var rest = match[2];\n\t\n\t\t        match[2].replace(REGEXES.attr, function (match, name) {\n\t\t          if (!(arguments[2] || arguments[3] || arguments[4] || arguments[5])) {\n\t\t            attrs[name] = '';\n\t\t          } else if (arguments[5]) {\n\t\t            attrs[arguments[5]] = '';\n\t\t            booleanAttrs[arguments[5]] = true;\n\t\t          } else {\n\t\t            attrs[name] = arguments[2] || arguments[3] || arguments[4] || REGEXES.fillAttr.test(name) && name || '';\n\t\t          }\n\t\n\t\t          rest = rest.replace(match, '');\n\t\t        });\n\t\n\t\t        return {\n\t\t          v: new _tokens.StartTagToken(match[1], match[0].length, attrs, booleanAttrs, !!match[3], rest.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, ''))\n\t\t        };\n\t\t      }();\n\t\n\t\t      if ((typeof _ret === 'undefined' ? 'undefined' : _typeof(_ret)) === \"object\") return _ret.v;\n\t\t    }\n\t\t  }\n\t\t}\n\t\n\t\t/**\n\t\t * Reads atomic tag token.\n\t\t *\n\t\t * @param {string} stream The input stream\n\t\t * @returns {AtomicTagToken}\n\t\t */\n\t\tfunction atomicTag(stream) {\n\t\t  var start = startTag(stream);\n\t\t  if (start) {\n\t\t    var rest = stream.slice(start.length);\n\t\t    // for optimization, we check first just for the end tag\n\t\t    if (rest.match(new RegExp('<\\/\\\\s*' + start.tagName + '\\\\s*>', 'i'))) {\n\t\t      // capturing the content is inefficient, so we do it inside the if\n\t\t      var match = rest.match(new RegExp('([\\\\s\\\\S]*?)<\\/\\\\s*' + start.tagName + '\\\\s*>', 'i'));\n\t\t      if (match) {\n\t\t        return new _tokens.AtomicTagToken(start.tagName, match[0].length + start.length, start.attrs, start.booleanAttrs, match[1]);\n\t\t      }\n\t\t    }\n\t\t  }\n\t\t}\n\t\n\t\t/**\n\t\t * Reads an end tag token.\n\t\t *\n\t\t * @param {string} stream The input stream\n\t\t * @returns {EndTagToken}\n\t\t */\n\t\tfunction endTag(stream) {\n\t\t  var match = stream.match(REGEXES.endTag);\n\t\t  if (match) {\n\t\t    return new _tokens.EndTagToken(match[1], match[0].length);\n\t\t  }\n\t\t}\n\t\n\t/***/ },\n\t/* 4 */\n\t/***/ function(module, exports, __webpack_require__) {\n\t\n\t\t'use strict';\n\t\n\t\texports.__esModule = true;\n\t\texports.EndTagToken = exports.AtomicTagToken = exports.StartTagToken = exports.TagToken = exports.CharsToken = exports.CommentToken = exports.Token = undefined;\n\t\n\t\tvar _utils = __webpack_require__(5);\n\t\n\t\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t\t/**\n\t\t * Token is a base class for all token types parsed.  Note we don't actually\n\t\t * use intheritance due to IE8's non-existent ES5 support.\n\t\t */\n\t\tvar Token =\n\t\t/**\n\t\t * Constructor.\n\t\t *\n\t\t * @param {string} type The type of the Token.\n\t\t * @param {Number} length The length of the Token text.\n\t\t */\n\t\texports.Token = function Token(type, length) {\n\t\t  _classCallCheck(this, Token);\n\t\n\t\t  this.type = type;\n\t\t  this.length = length;\n\t\t  this.text = '';\n\t\t};\n\t\n\t\t/**\n\t\t * CommentToken represents comment tags.\n\t\t */\n\t\n\t\n\t\tvar CommentToken = exports.CommentToken = function () {\n\t\t  /**\n\t\t   * Constructor.\n\t\t   *\n\t\t   * @param {string} content The content of the comment\n\t\t   * @param {Number} length The length of the Token text.\n\t\t   */\n\t\t  function CommentToken(content, length) {\n\t\t    _classCallCheck(this, CommentToken);\n\t\n\t\t    this.type = 'comment';\n\t\t    this.length = length || (content ? content.length : 0);\n\t\t    this.text = '';\n\t\t    this.content = content;\n\t\t  }\n\t\n\t\t  CommentToken.prototype.toString = function toString() {\n\t\t    return '<!--' + this.content;\n\t\t  };\n\t\n\t\t  return CommentToken;\n\t\t}();\n\t\n\t\t/**\n\t\t * CharsToken represents non-tag characters.\n\t\t */\n\t\n\t\n\t\tvar CharsToken = exports.CharsToken = function () {\n\t\t  /**\n\t\t   * Constructor.\n\t\t   *\n\t\t   * @param {Number} length The length of the Token text.\n\t\t   */\n\t\t  function CharsToken(length) {\n\t\t    _classCallCheck(this, CharsToken);\n\t\n\t\t    this.type = 'chars';\n\t\t    this.length = length;\n\t\t    this.text = '';\n\t\t  }\n\t\n\t\t  CharsToken.prototype.toString = function toString() {\n\t\t    return this.text;\n\t\t  };\n\t\n\t\t  return CharsToken;\n\t\t}();\n\t\n\t\t/**\n\t\t * TagToken is a base class for all tag-based Tokens.\n\t\t */\n\t\n\t\n\t\tvar TagToken = exports.TagToken = function () {\n\t\t  /**\n\t\t   * Constructor.\n\t\t   *\n\t\t   * @param {string} type The type of the token.\n\t\t   * @param {string} tagName The tag name.\n\t\t   * @param {Number} length The length of the Token text.\n\t\t   * @param {Object} attrs The dictionary of attributes and values\n\t\t   * @param {Object} booleanAttrs If an entry has 'true' then the attribute\n\t\t   *                              is a boolean attribute\n\t\t   */\n\t\t  function TagToken(type, tagName, length, attrs, booleanAttrs) {\n\t\t    _classCallCheck(this, TagToken);\n\t\n\t\t    this.type = type;\n\t\t    this.length = length;\n\t\t    this.text = '';\n\t\t    this.tagName = tagName;\n\t\t    this.attrs = attrs;\n\t\t    this.booleanAttrs = booleanAttrs;\n\t\t    this.unary = false;\n\t\t    this.html5Unary = false;\n\t\t  }\n\t\n\t\t  /**\n\t\t   * Formats the given token tag.\n\t\t   *\n\t\t   * @param {TagToken} tok The TagToken to format.\n\t\t   * @param {?string} [content=null] The content of the token.\n\t\t   * @returns {string} The formatted tag.\n\t\t   */\n\t\n\t\n\t\t  TagToken.formatTag = function formatTag(tok) {\n\t\t    var content = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\t\n\t\t    var str = '<' + tok.tagName;\n\t\t    for (var key in tok.attrs) {\n\t\t      if (tok.attrs.hasOwnProperty(key)) {\n\t\t        str += ' ' + key;\n\t\n\t\t        var val = tok.attrs[key];\n\t\t        if (typeof tok.booleanAttrs === 'undefined' || typeof tok.booleanAttrs[key] === 'undefined') {\n\t\t          str += '=\"' + (0, _utils.escapeQuotes)(val) + '\"';\n\t\t        }\n\t\t      }\n\t\t    }\n\t\n\t\t    if (tok.rest) {\n\t\t      str += ' ' + tok.rest;\n\t\t    }\n\t\n\t\t    if (tok.unary && !tok.html5Unary) {\n\t\t      str += '/>';\n\t\t    } else {\n\t\t      str += '>';\n\t\t    }\n\t\n\t\t    if (content !== undefined && content !== null) {\n\t\t      str += content + '</' + tok.tagName + '>';\n\t\t    }\n\t\n\t\t    return str;\n\t\t  };\n\t\n\t\t  return TagToken;\n\t\t}();\n\t\n\t\t/**\n\t\t * StartTagToken represents a start token.\n\t\t */\n\t\n\t\n\t\tvar StartTagToken = exports.StartTagToken = function () {\n\t\t  /**\n\t\t   * Constructor.\n\t\t   *\n\t\t   * @param {string} tagName The tag name.\n\t\t   * @param {Number} length The length of the Token text\n\t\t   * @param {Object} attrs The dictionary of attributes and values\n\t\t   * @param {Object} booleanAttrs If an entry has 'true' then the attribute\n\t\t   *                              is a boolean attribute\n\t\t   * @param {boolean} unary True if the tag is a unary tag\n\t\t   * @param {string} rest The rest of the content.\n\t\t   */\n\t\t  function StartTagToken(tagName, length, attrs, booleanAttrs, unary, rest) {\n\t\t    _classCallCheck(this, StartTagToken);\n\t\n\t\t    this.type = 'startTag';\n\t\t    this.length = length;\n\t\t    this.text = '';\n\t\t    this.tagName = tagName;\n\t\t    this.attrs = attrs;\n\t\t    this.booleanAttrs = booleanAttrs;\n\t\t    this.html5Unary = false;\n\t\t    this.unary = unary;\n\t\t    this.rest = rest;\n\t\t  }\n\t\n\t\t  StartTagToken.prototype.toString = function toString() {\n\t\t    return TagToken.formatTag(this);\n\t\t  };\n\t\n\t\t  return StartTagToken;\n\t\t}();\n\t\n\t\t/**\n\t\t * AtomicTagToken represents an atomic tag.\n\t\t */\n\t\n\t\n\t\tvar AtomicTagToken = exports.AtomicTagToken = function () {\n\t\t  /**\n\t\t   * Constructor.\n\t\t   *\n\t\t   * @param {string} tagName The name of the tag.\n\t\t   * @param {Number} length The length of the tag text.\n\t\t   * @param {Object} attrs The attributes.\n\t\t   * @param {Object} booleanAttrs If an entry has 'true' then the attribute\n\t\t   *                              is a boolean attribute\n\t\t   * @param {string} content The content of the tag.\n\t\t   */\n\t\t  function AtomicTagToken(tagName, length, attrs, booleanAttrs, content) {\n\t\t    _classCallCheck(this, AtomicTagToken);\n\t\n\t\t    this.type = 'atomicTag';\n\t\t    this.length = length;\n\t\t    this.text = '';\n\t\t    this.tagName = tagName;\n\t\t    this.attrs = attrs;\n\t\t    this.booleanAttrs = booleanAttrs;\n\t\t    this.unary = false;\n\t\t    this.html5Unary = false;\n\t\t    this.content = content;\n\t\t  }\n\t\n\t\t  AtomicTagToken.prototype.toString = function toString() {\n\t\t    return TagToken.formatTag(this, this.content);\n\t\t  };\n\t\n\t\t  return AtomicTagToken;\n\t\t}();\n\t\n\t\t/**\n\t\t * EndTagToken represents an end tag.\n\t\t */\n\t\n\t\n\t\tvar EndTagToken = exports.EndTagToken = function () {\n\t\t  /**\n\t\t   * Constructor.\n\t\t   *\n\t\t   * @param {string} tagName The name of the tag.\n\t\t   * @param {Number} length The length of the tag text.\n\t\t   */\n\t\t  function EndTagToken(tagName, length) {\n\t\t    _classCallCheck(this, EndTagToken);\n\t\n\t\t    this.type = 'endTag';\n\t\t    this.length = length;\n\t\t    this.text = '';\n\t\t    this.tagName = tagName;\n\t\t  }\n\t\n\t\t  EndTagToken.prototype.toString = function toString() {\n\t\t    return '</' + this.tagName + '>';\n\t\t  };\n\t\n\t\t  return EndTagToken;\n\t\t}();\n\t\n\t/***/ },\n\t/* 5 */\n\t/***/ function(module, exports) {\n\t\n\t\t'use strict';\n\t\n\t\texports.__esModule = true;\n\t\texports.escapeQuotes = escapeQuotes;\n\t\n\t\t/**\n\t\t * Escape quotes in the given value.\n\t\t *\n\t\t * @param {string} value The value to escape.\n\t\t * @param {string} [defaultValue=''] The default value to return if value is falsy.\n\t\t * @returns {string}\n\t\t */\n\t\tfunction escapeQuotes(value) {\n\t\t  var defaultValue = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n\t\n\t\t  // There's no lookback in JS, so /(^|[^\\\\])\"/ only matches the first of two `\"`s.\n\t\t  // Instead, just match anything before a double-quote and escape if it's not already escaped.\n\t\t  return !value ? defaultValue : value.replace(/([^\"]*)\"/g, function (_, prefix) {\n\t\t    return (/\\\\/.test(prefix) ? prefix + '\"' : prefix + '\\\\\"'\n\t\t    );\n\t\t  });\n\t\t}\n\t\n\t/***/ },\n\t/* 6 */\n\t/***/ function(module, exports) {\n\t\n\t\t'use strict';\n\t\n\t\texports.__esModule = true;\n\t\texports['default'] = fixedReadTokenFactory;\n\t\t/**\n\t\t * Empty Elements - HTML 4.01\n\t\t *\n\t\t * @type {RegExp}\n\t\t */\n\t\tvar EMPTY = /^(AREA|BASE|BASEFONT|BR|COL|FRAME|HR|IMG|INPUT|ISINDEX|LINK|META|PARAM|EMBED)$/i;\n\t\n\t\t/**\n\t\t * Elements that you can intentionally leave open (and which close themselves)\n\t\t *\n\t\t * @type {RegExp}\n\t\t */\n\t\tvar CLOSESELF = /^(COLGROUP|DD|DT|LI|OPTIONS|P|TD|TFOOT|TH|THEAD|TR)$/i;\n\t\n\t\t/**\n\t\t * Corrects a token.\n\t\t *\n\t\t * @param {Token} tok The token to correct\n\t\t * @returns {Token} The corrected token\n\t\t */\n\t\tfunction correct(tok) {\n\t\t  if (tok && tok.type === 'startTag') {\n\t\t    tok.unary = EMPTY.test(tok.tagName) || tok.unary;\n\t\t    tok.html5Unary = !/\\/>$/.test(tok.text);\n\t\t  }\n\t\t  return tok;\n\t\t}\n\t\n\t\t/**\n\t\t * Peeks at the next token in the parser.\n\t\t *\n\t\t * @param {HtmlParser} parser The parser\n\t\t * @param {Function} readTokenImpl The underlying readToken implementation\n\t\t * @returns {Token} The next token\n\t\t */\n\t\tfunction peekToken(parser, readTokenImpl) {\n\t\t  var tmp = parser.stream;\n\t\t  var tok = correct(readTokenImpl());\n\t\t  parser.stream = tmp;\n\t\t  return tok;\n\t\t}\n\t\n\t\t/**\n\t\t * Closes the last token.\n\t\t *\n\t\t * @param {HtmlParser} parser The parser\n\t\t * @param {Array<Token>} stack The stack\n\t\t */\n\t\tfunction closeLast(parser, stack) {\n\t\t  var tok = stack.pop();\n\t\n\t\t  // prepend close tag to stream.\n\t\t  parser.prepend('</' + tok.tagName + '>');\n\t\t}\n\t\n\t\t/**\n\t\t * Create a new token stack.\n\t\t *\n\t\t * @returns {Array<Token>}\n\t\t */\n\t\tfunction newStack() {\n\t\t  var stack = [];\n\t\n\t\t  stack.last = function () {\n\t\t    return this[this.length - 1];\n\t\t  };\n\t\n\t\t  stack.lastTagNameEq = function (tagName) {\n\t\t    var last = this.last();\n\t\t    return last && last.tagName && last.tagName.toUpperCase() === tagName.toUpperCase();\n\t\t  };\n\t\n\t\t  stack.containsTagName = function (tagName) {\n\t\t    for (var i = 0, tok; tok = this[i]; i++) {\n\t\t      if (tok.tagName === tagName) {\n\t\t        return true;\n\t\t      }\n\t\t    }\n\t\t    return false;\n\t\t  };\n\t\n\t\t  return stack;\n\t\t}\n\t\n\t\t/**\n\t\t * Return a readToken implementation that fixes input.\n\t\t *\n\t\t * @param {HtmlParser} parser The parser\n\t\t * @param {Object} options Options for fixing\n\t\t * @param {boolean} options.tagSoupFix True to fix tag soup scenarios\n\t\t * @param {boolean} options.selfCloseFix True to fix self-closing tags\n\t\t * @param {Function} readTokenImpl The underlying readToken implementation\n\t\t * @returns {Function}\n\t\t */\n\t\tfunction fixedReadTokenFactory(parser, options, readTokenImpl) {\n\t\t  var stack = newStack();\n\t\n\t\t  var handlers = {\n\t\t    startTag: function startTag(tok) {\n\t\t      var tagName = tok.tagName;\n\t\n\t\t      if (tagName.toUpperCase() === 'TR' && stack.lastTagNameEq('TABLE')) {\n\t\t        parser.prepend('<TBODY>');\n\t\t        prepareNextToken();\n\t\t      } else if (options.selfCloseFix && CLOSESELF.test(tagName) && stack.containsTagName(tagName)) {\n\t\t        if (stack.lastTagNameEq(tagName)) {\n\t\t          closeLast(parser, stack);\n\t\t        } else {\n\t\t          parser.prepend('</' + tok.tagName + '>');\n\t\t          prepareNextToken();\n\t\t        }\n\t\t      } else if (!tok.unary) {\n\t\t        stack.push(tok);\n\t\t      }\n\t\t    },\n\t\t    endTag: function endTag(tok) {\n\t\t      var last = stack.last();\n\t\t      if (last) {\n\t\t        if (options.tagSoupFix && !stack.lastTagNameEq(tok.tagName)) {\n\t\t          // cleanup tag soup\n\t\t          closeLast(parser, stack);\n\t\t        } else {\n\t\t          stack.pop();\n\t\t        }\n\t\t      } else if (options.tagSoupFix) {\n\t\t        // cleanup tag soup part 2: skip this token\n\t\t        readTokenImpl();\n\t\t        prepareNextToken();\n\t\t      }\n\t\t    }\n\t\t  };\n\t\n\t\t  function prepareNextToken() {\n\t\t    var tok = peekToken(parser, readTokenImpl);\n\t\t    if (tok && handlers[tok.type]) {\n\t\t      handlers[tok.type](tok);\n\t\t    }\n\t\t  }\n\t\n\t\t  return function fixedReadToken() {\n\t\t    prepareNextToken();\n\t\t    return correct(readTokenImpl());\n\t\t  };\n\t\t}\n\t\n\t/***/ }\n\t/******/ ])\n\t});\n\t;\n\n/***/ },\n/* 4 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\texports.__esModule = true;\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\t\n\texports.existy = existy;\n\texports.isFunction = isFunction;\n\texports.each = each;\n\texports.eachKey = eachKey;\n\texports.defaults = defaults;\n\texports.toArray = toArray;\n\texports.last = last;\n\texports.isTag = isTag;\n\texports.isScript = isScript;\n\texports.isStyle = isStyle;\n\t/**\n\t * Determine if the thing is not undefined and not null.\n\t *\n\t * @param {*} thing The thing to test\n\t * @returns {boolean} True if the thing is not undefined and not null.\n\t */\n\tfunction existy(thing) {\n\t  return thing !== void 0 && thing !== null;\n\t}\n\t\n\t/**\n\t * Is this a function?\n\t *\n\t * @param {*} x The variable to test\n\t * @returns {boolean} True if the variable is a function\n\t */\n\tfunction isFunction(x) {\n\t  return 'function' === typeof x;\n\t}\n\t\n\t/**\n\t * Loop over each item in an array-like value.\n\t *\n\t * @param {Array<*>} arr The array to loop over\n\t * @param {Function} fn The function to call\n\t * @param {?Object} target The object to bind to the function\n\t */\n\tfunction each(arr, fn, target) {\n\t  var i = void 0;\n\t  var len = arr && arr.length || 0;\n\t  for (i = 0; i < len; i++) {\n\t    fn.call(target, arr[i], i);\n\t  }\n\t}\n\t\n\t/**\n\t * Loop over each key/value pair in a hash.\n\t *\n\t * @param {Object} obj The object\n\t * @param {Function} fn The function to call\n\t * @param {?Object} target The object to bind to the function\n\t */\n\tfunction eachKey(obj, fn, target) {\n\t  for (var key in obj) {\n\t    if (obj.hasOwnProperty(key)) {\n\t      fn.call(target, key, obj[key]);\n\t    }\n\t  }\n\t}\n\t\n\t/**\n\t * Set default options where some option was not specified.\n\t *\n\t * @param {Object} options The destination\n\t * @param {Object} _defaults The defaults\n\t * @returns {Object}\n\t */\n\tfunction defaults(options, _defaults) {\n\t  options = options || {};\n\t  eachKey(_defaults, function (key, val) {\n\t    if (!existy(options[key])) {\n\t      options[key] = val;\n\t    }\n\t  });\n\t  return options;\n\t}\n\t\n\t/**\n\t * Convert value (e.g., a NodeList) to an array.\n\t *\n\t * @param {*} obj The object\n\t * @returns {Array<*>}\n\t */\n\tfunction toArray(obj) {\n\t  try {\n\t    return Array.prototype.slice.call(obj);\n\t  } catch (e) {\n\t    var _ret = function () {\n\t      var ret = [];\n\t      each(obj, function (val) {\n\t        ret.push(val);\n\t      });\n\t      return {\n\t        v: ret\n\t      };\n\t    }();\n\t\n\t    if ((typeof _ret === 'undefined' ? 'undefined' : _typeof(_ret)) === \"object\") return _ret.v;\n\t  }\n\t}\n\t\n\t/**\n\t * Get the last item in an array\n\t *\n\t * @param {Array<*>} array The array\n\t * @returns {*} The last item in the array\n\t */\n\tfunction last(array) {\n\t  return array[array.length - 1];\n\t}\n\t\n\t/**\n\t * Test if token is a script tag.\n\t *\n\t * @param {Object} tok The token\n\t * @param {String} tag The tag name\n\t * @returns {boolean} True if the token is a script tag\n\t */\n\tfunction isTag(tok, tag) {\n\t  return !tok || !(tok.type === 'startTag' || tok.type === 'atomicTag') || !('tagName' in tok) ? !1 : !!~tok.tagName.toLowerCase().indexOf(tag);\n\t}\n\t\n\t/**\n\t * Test if token is a script tag.\n\t *\n\t * @param {Object} tok The token\n\t * @returns {boolean} True if the token is a script tag\n\t */\n\tfunction isScript(tok) {\n\t  return isTag(tok, 'script');\n\t}\n\t\n\t/**\n\t * Test if token is a style tag.\n\t *\n\t * @param {Object} tok The token\n\t * @returns {boolean} True if the token is a style tag\n\t */\n\tfunction isStyle(tok) {\n\t  return isTag(tok, 'style');\n\t}\n\n/***/ }\n/******/ ])\n});\n;\n//# sourceMappingURL=postscribe.js.map\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/postscribe/dist/postscribe.js\n// module id = 5\n// module chunks = 0","/**\n * Handles postMessage requests and responses for replacing native placeholder\n * values in native creative templates.\n */\n\nimport { fireNativeClickTrackers, fireNativeImpressionTrackers } from './nativeORTBTrackerManager';\nimport { sendRequest, loadScript } from './utils';\nimport {prebidMessenger} from './messaging.js';\nimport { newEnvironment } from './environment.js';\n\nconst envionment = newEnvironment(window);\n/*\n * Native asset->key mapping from Prebid.js/src/constants.json\n * https://github.com/prebid/Prebid.js/blob/8635c91942de9df4ec236672c39b19448545a812/src/constants.json#L67\n */\nconst NATIVE_KEYS = {\n  title: 'hb_native_title',\n  body: 'hb_native_body',\n  body2: 'hb_native_body2',\n  privacyLink: 'hb_native_privacy',\n  sponsoredBy: 'hb_native_brand',\n  image: 'hb_native_image',\n  icon: 'hb_native_icon',\n  clickUrl: 'hb_native_linkurl',\n  displayUrl: 'hb_native_displayurl',\n  cta: 'hb_native_cta',\n  rating: 'hb_native_rating',\n  address: 'hb_native_address',\n  downloads: 'hb_native_downloads',\n  likes: 'hb_native_likes',\n  phone: 'hb_native_phone',\n  price: 'hb_native_price',\n  salePrice: 'hb_native_saleprice',\n  rendererUrl: 'hb_renderer_url',\n};\n\n// Asset type mapping as per Native IAB spec 1.2\n// https://www.iab.com/wp-content/uploads/2017/04/OpenRTB-Native-Ads-Specification-Draft_1.2_2017-04.pdf#page=40\nconst assetTypeMapping = {\n  'image': {\n    1: 'icon',\n    3: 'image'\n  },\n  'data': {\n    1: 'sponsoredBy',\n    2: 'body',\n    3: 'rating',\n    4: 'likes',\n    5: 'downloads',\n    6: 'price',\n    7: 'salePrice',\n    8: 'phone',\n    9: 'address',\n    10: 'body2',\n    11: 'displayUrl',\n    12: 'cta',\n  }\n}\n\nconst DEFAULT_CACHE_HOST = 'prebid.adnxs.com';\nconst DEFAULT_CACHE_PATH = '/pbc/v1/cache';\n\nexport function newNativeAssetManager(win, pubUrl) {\n  const sendMessage = prebidMessenger(pubUrl, win);\n  let callback;\n  let errorCountEscapeHatch = 0;\n  let cancelMessageListener;\n\n  function stopListening() {\n    if (cancelMessageListener != null) {\n      cancelMessageListener();\n      cancelMessageListener = null;\n    }\n  }\n\n\n\n  function getCacheEndpoint(cacheHost, cachePath) {\n    let host = (typeof cacheHost === 'undefined' || cacheHost === \"\") ? DEFAULT_CACHE_HOST : cacheHost;\n    let path = (typeof cachePath === 'undefined' || cachePath === \"\") ? DEFAULT_CACHE_PATH : cachePath;\n\n    return `https://${host}${path}`;\n  }\n\n  function parseResponse(response) {\n    let bidObject;\n    try {\n      bidObject = JSON.parse(response);\n    } catch (error) {\n      console.log(`Error parsing response from cache host: ${error}`);\n    }\n    return bidObject;\n  }\n\n  function transformToPrebidKeys(adMarkup) {\n    let assets = [];\n    let clicktrackers;\n    let assetsFromMarkup = adMarkup.assets;\n    assetsFromMarkup.forEach((asset) => {\n      if (asset.img) {\n        if (assetTypeMapping['image'][asset.img.type]) {\n          assets.push({\n            'key' : assetTypeMapping['image'][asset.img.type],\n            'value' : asset.img.url\n          })\n        } else {\n          console.log('ERROR: Invalid image type for image asset');\n        }\n      } else if (asset.data) {\n        if (assetTypeMapping['data'][asset.data.type]) {\n          assets.push({\n            'key' : assetTypeMapping['data'][asset.data.type],\n            'value' : asset.data.value\n          })\n        } else {\n          console.log('ERROR: Invalid data type for data asset');\n        }\n      } else if (asset.title) {\n        assets.push({\n          'key' : 'title',\n          'value' : asset.title.text\n        })\n      }\n    })\n\n    if (adMarkup.link) {\n      if (adMarkup.link.clicktrackers) {\n        clicktrackers = adMarkup.link.clicktrackers;\n      }\n      assets.push({\n        'key' : 'clickUrl',\n        'value' : adMarkup.link.url\n      })\n    }\n\n    return {\n      assets,\n      clicktrackers,\n      'imptrackers' : adMarkup.imptrackers\n    }\n  }\n\n  function requestAssetsFromCache(tagData) {\n    let ajaxCallback = function(response) {\n      let bidResponse = parseResponse(response);\n      if (bidResponse && bidResponse.adm) {\n        let markup = parseResponse(bidResponse.adm);\n        if (markup && markup.assets) {\n          let data = transformToPrebidKeys(markup);\n          const body = win.document.body.innerHTML;\n          const newHtml = replace(body, data);\n          win.document.body.innerHTML = newHtml;\n\n          callback && callback({\n            clickTrackers: data.clicktrackers,\n            impTrackers: data.imptrackers\n          });\n        } else {\n          // TODO Shall we just write the markup in the page\n        }\n      }\n    }\n    let uuid = tagData.uuid;\n    let adUrl = `${getCacheEndpoint(tagData.cacheHost, tagData.cachePath)}?uuid=${uuid}`;\n    sendRequest(adUrl, ajaxCallback);\n  }\n\n  function loadMobileAssets(tagData, cb) {\n    const placeholders = scanForPlaceholders();\n    if (placeholders.length > 0) {\n      callback = cb;\n      requestAssetsFromCache(tagData);\n    }\n  }\n\n  /*\n   * Entry point to search for placeholderes and set up postmessage roundtrip\n   * to retrieve native assets. Looks for placeholders for the given adId and\n   * fires a callback after the native html is updated. If no placeholders found\n   * and requestAllAssets flag is set in the tag, postmessage roundtrip\n   * to retrieve native assets that have a value on the corresponding bid\n   */\n  function loadAssets(adId, cb) {\n    const placeholders = scanForPlaceholders(adId), flag = (typeof win.pbNativeData !== 'undefined');\n\n    if (flag && win.pbNativeData.hasOwnProperty('assetsToReplace')) {\n        win.pbNativeData.assetsToReplace.forEach((asset) => {\n          const key = (asset.match(/hb_native_/i)) ? asset : NATIVE_KEYS[asset];\n          if (key) {placeholders.push(key);}\n        });\n    }\n\n    if (flag && win.pbNativeData.hasOwnProperty('requestAllAssets') && win.pbNativeData.requestAllAssets) {\n      callback = cb;\n      cancelMessageListener = requestAllAssets(adId);\n    } else if (placeholders.length > 0) {\n      callback = cb;\n      cancelMessageListener = requestAssets(adId, placeholders);\n    }\n  }\n\n  /*\n   * Searches the DOM for placeholder values sent in by Prebid Native\n   */\n  function scanForPlaceholders(adId) {\n    let placeholders = [];\n    const doc = win.document;\n    const flag = (typeof win.pbNativeData !== 'undefined');\n\n    Object.keys(NATIVE_KEYS).forEach(key => {\n      const placeholderKey = NATIVE_KEYS[key];\n      const placeholder = (adId && !flag) ? `${placeholderKey}:${adId}` : `${placeholderKey}`;\n      const placeholderIndex = (~doc.body.innerHTML.indexOf(placeholder)) ? doc.body.innerHTML.indexOf(placeholder) : (doc.head.innerHTML && doc.head.innerHTML.indexOf(placeholder));\n\n      if (~placeholderIndex) {\n        placeholders.push(placeholderKey);\n      }\n    });\n\n    return placeholders;\n  }\n\n  /*\n   * Sends postmessage to Prebid for asset placeholders found in the native\n   * creative template, and setups up a listener for when Prebid responds.\n   */\n  function requestAssets(adId, assets) {\n    const message = {\n      message: 'Prebid Native',\n      action: 'assetRequest',\n      adId,\n      assets,\n    };\n\n    return sendMessage(message, replaceAssets);\n  }\n\n  /*\n   * Sends postmessage to Prebid for asset placeholders found in the native\n   * creative template, and setups up a listener for when Prebid responds.\n   */\n  function requestAllAssets(adId) {\n    const message = {\n      message: 'Prebid Native',\n      action: 'allAssetRequest',\n      adId,\n    };\n    return sendMessage(message, replaceAssets);\n  }\n\n  /*\n   * Sends postmessage to Prebid for native resize\n   */\n  function requestHeightResize(adId, height) {\n    const message = {\n      message: 'Prebid Native',\n      action: 'resizeNativeHeight',\n      adId,\n      height,\n    };\n    sendMessage(message);\n  }\n\n  /*\n   * Postmessage listener for when Prebid responds with requested native assets.\n   */\n  function replaceAssets(event) {\n    var data = {};\n\n    try {\n      data = JSON.parse(event.data);\n    } catch (e) {\n      if (errorCountEscapeHatch++ > 10) {\n        /*\n         * if for some reason Prebid never responds with the native assets,\n         * get rid of this listener because other messages won't stop coming\n         */\n        stopListening();\n      }\n      return;\n    }\n\n    if (data.message === 'assetResponse') {\n      const body = win.document.body.innerHTML;\n      const head = win.document.head.innerHTML;\n      const flag = (typeof win.pbNativeData !== 'undefined');\n\n      if (flag && data.adId !== win.pbNativeData.adId) return;\n\n      if (head) win.document.head.innerHTML = replace(head, data);\n\n      let renderPayload = data.assets;\n      if (data.ortb) {\n        renderPayload = data.ortb;\n        callback = () => {\n          fireNativeImpressionTrackers(data.ortb);\n          fireNativeClickTrackers(data.ortb);\n        }\n      }\n\n      if ((data.hasOwnProperty('rendererUrl') && data.rendererUrl) || (flag && win.pbNativeData.hasOwnProperty('rendererUrl'))) {\n        if (win.renderAd) {\n          const newHtml = (win.renderAd && win.renderAd(renderPayload)) || '';\n\n          renderAd(newHtml, data);\n        } else if (document.getElementById('pb-native-renderer')) {\n          document.getElementById('pb-native-renderer').addEventListener('load', function() {\n            const newHtml = (win.renderAd && win.renderAd(renderPayload)) || '';\n\n            renderAd(newHtml, data);\n          });\n        } else {\n          loadScript(win, ((flag && win.pbNativeData.hasOwnProperty('rendererUrl') && win.pbNativeData.rendererUrl) || data.rendererUrl), function() {\n            const newHtml = (win.renderAd && win.renderAd(renderPayload)) || '';\n\n            renderAd(newHtml, data);\n          })\n        }\n      } else if ((data.hasOwnProperty('adTemplate') && data.adTemplate)||(flag && win.pbNativeData.hasOwnProperty('adTemplate'))) {\n        const template =  (flag && win.pbNativeData.hasOwnProperty('adTemplate') && win.pbNativeData.adTemplate) || data.adTemplate;\n        const newHtml = replace(template, data);\n        \n        renderAd(newHtml, data);\n      } else {\n        const newHtml = replace(body, data);\n\n        win.document.body.innerHTML = newHtml;\n        callback && callback();\n        stopListening();\n      }\n    }\n  }\n\n  /** This function returns the element that contains the current iframe. */\n  function getCurrentFrameContainer(win) {\n    let currentWindow = win;\n    let currentParentWindow;\n\n    while (currentWindow !== win.top) {\n        currentParentWindow = currentWindow.parent;\n        if (!currentParentWindow.frames || !currentParentWindow.frames.length) return null;\n        for (let idx = 0; idx < currentParentWindow.frames.length; idx++)\n            if (currentParentWindow.frames[idx] === currentWindow) {\n              if (!currentParentWindow.document) return null; \n                for (let frameElement of currentParentWindow.document.getElementsByTagName('iframe')) {\n                    if (!frameElement.contentWindow) return null;\n                    if (frameElement.contentWindow === currentWindow) {\n                        return frameElement.parentElement;\n                    }\n                }\n            }\n    }\n}\n\n  function renderAd(html, bid) {\n    // if the current iframe is not a safeframe, try to set the \n    // current iframe width to the width of the container. This \n    // is to handle the case where the native ad is rendered inside \n    // a GAM display ad. \n    if (!envionment.isSafeFrame()) {\n      let iframeContainer = getCurrentFrameContainer(win);\n      if (iframeContainer) {\n        let width =  iframeContainer.getBoundingClientRect().width;\n        win.document.body.style.width = `${width}px`;\n      }\n    }\n    win.document.body.innerHTML += html;\n    callback && callback();\n    win.removeEventListener('message', replaceAssets);\n    stopListening();\n    requestHeightResize(bid.adId, (document.body.clientHeight || document.body.offsetHeight));\n\n    if (typeof window.postRenderAd === 'function') {\n      window.postRenderAd(bid);\n    }\n  }\n\n  function replaceORTBAssetsAndLinks(html, ortb) {\n    const getAssetValue = (asset) => {\n      if (asset.img) {\n        return asset.img.url;\n      }\n      if (asset.data) {\n        return asset.data.value;\n      }\n      if (asset.title) {\n        return asset.title.text;\n      }\n      if (asset.video) {\n        return asset.video.vasttag;\n      }\n    }\n\n    ortb.assets.forEach(asset => {\n      html = html.replace(`##hb_native_asset_id_${asset.id}##`, getAssetValue(asset));\n      if (asset.link && asset.link.url) {\n        html = html.replace(`##hb_native_asset_link_id_${asset.id}##`, asset.link.url);\n      }\n    });\n\n    if (ortb.privacy) {\n      html = html.replace(\"##hb_native_privacy##\", ortb.privacy);\n    }\n\n    if (ortb.link) {\n      html = html.replaceAll(\"##hb_native_linkurl##\", ortb.link.url);\n    }\n  \n    return html;\n  }\n\n  /**\n   * Replaces occurrences of native placeholder values with their actual values\n   * in the given document.\n   */\n  function replace(document, data) {\n    let html = document;\n    if (data.ortb) {\n      return replaceORTBAssetsAndLinks(html, data.ortb);\n    } else if (!Array.isArray(data.assets)) {\n      return html;\n    }\n\n    let assets = data.assets;\n    let adId = data.adId;\n\n    assets.forEach(asset => {\n      const flag = (typeof win.pbNativeData !== 'undefined');\n      const searchString = (adId && !flag) ? `${NATIVE_KEYS[asset.key]}:${adId}` : ((flag) ? '##'+`${NATIVE_KEYS[asset.key]}`+'##' : `${NATIVE_KEYS[asset.key]}`);\n      const searchStringRegex = new RegExp(searchString, 'g');\n      html = html.replace(searchStringRegex, asset.value);\n    });\n\n    return html;\n  }\n\n  return {\n    loadAssets,\n    loadMobileAssets\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/nativeAssetManager.js","import { loadScript, triggerPixel } from \"./utils\";\n\nconst AD_ANCHOR_CLASS_NAME = 'pb-click';\nconst ASSET_ID_ELEMENT_ATTRIBUTE = 'hb_native_asset_id';\n\nexport function fireNativeImpressionTrackers(ortb) {\n    const eventTrackers = ortb.eventtrackers || [];\n    // get only impression event trackers (tracker.event === 1)\n    const impressionTrackers = eventTrackers.filter(tracker => tracker.event === 1);\n\n    // get urls of img impression trackers\n    let imgEventTrackers = impressionTrackers.filter(ev => ev.method == 1).map(e => e.url);\n    // get urls of js impression trackers\n    let jsEventTrackers = impressionTrackers.filter(ev => ev.method == 2).map(e => e.url);\n\n    imgEventTrackers.forEach(url => triggerPixel(url));\n    jsEventTrackers.forEach(url => loadScript(window, url));\n}\n\nexport function fireNativeClickTrackers(ortb) {\n    const adElements = document.getElementsByClassName(AD_ANCHOR_CLASS_NAME) || [];\n    // get all assets that have 'link' property, map asset.id -> asset.link\n    const assetIdLinkMap = ortb.assets.filter(a => a.link).reduce((map, asset) => (map[asset.id] = asset.link, map), {});\n    const masterClickTrackers = ortb.link.clicktrackers || [];\n    for (let i = 0; i < adElements.length; i++) {\n        adElements[i].addEventListener('click', (event) => {\n            let targetElement = event.target;\n            // check if clicked element is associated with any native asset (look for 'hb_native_asset_id' attribute)\n            let assetId = targetElement && targetElement.getAttribute(ASSET_ID_ELEMENT_ATTRIBUTE);\n            let assetLink = assetIdLinkMap[assetId];\n            let clickTrackers = masterClickTrackers;\n            // if asset has link object, use clicktrackers from the asset\n            if (assetLink) {\n                clickTrackers = assetLink.clicktrackers || [];\n            }\n            clickTrackers.forEach(url => triggerPixel(url));\n        }, true);\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/nativeORTBTrackerManager.js","/***************************************\n * Detect Environment Helper Functions\n ***************************************/\n\n/**\n * Functions to detect below environments:\n *  Amp: google Accelerate Mobile Pages ampproject.org\n *  SafeFrame: SafeFrame\n *  CrossDomain: An iframe that can't get to the top window\n *  Mobile App: function to detect mobile app environment\n */\n\n\nexport function newEnvironment(win) {\n  /**\n   * @param {String} uuid key value from auction, contains the cache id of the winning bid stored in prebid cache\n   * @returns true if there is an AMP context object\n   */\n  function isAmp(uuid) {\n    // TODO Use amp context once it is available in cross domain\n    // https://github.com/ampproject/amphtml/issues/6829\n    return typeof uuid === 'string' && uuid !== \"\" && isCrossDomain();\n  }\n\n  /**\n   * @returns true if the environment is a SafeFrame.\n   */\n  function isSafeFrame() {\n    return !!(win.$sf && win.$sf.ext);\n  }\n\n  /**\n    * Return true if we are in an iframe and can't access the top window.\n    * @returns true if the environment is a Cross Domain\n    */\n  function isCrossDomain() {\n    return win.top !== win && !canInspectWindow(win);\n  }\n\n  /**\n   * Returns true if win's properties can be accessed and win is defined.\n   * This functioned is used to determine if a window is cross-domained\n   * from the perspective of the current window.\n   * @param {!Window} win\n   * @return {boolean}\n   */\n  function canInspectWindow(win) {\n    try {\n      // force an exception in x-domain environments. #1509\n      win.top.location.toString();\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n\n  /**\n   * Returns true if we can find the prebid global object (eg pbjs) as we\n   * climb the accessible windows.  Return false if it's not found.\n   * @returns {boolean}\n   */\n  function canLocatePrebid() {\n    let result = false;\n    let currentWindow = win;\n    \n    while (!result) {\n      try {\n        if (currentWindow.pbjs) {\n          result = true;\n          break;\n        }\n      } catch (e) { }\n      if (currentWindow === window.top) break;\n      \n      currentWindow = currentWindow.parent;\n    }\n    return result;\n  }\n\n  /**\n   * @param {String} env key value from auction, indicates the environment where tag is served\n   * @returns true if env exists and is equal to the string 'mobile-app'\n   */\n  function isMobileApp(env) {\n    return env && env === 'mobile-app';\n  }\n\n  return {\n    isMobileApp,\n    isCrossDomain,\n    isSafeFrame,\n    isAmp,\n    canLocatePrebid\n  }\n}\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/environment.js"],"sourceRoot":""}